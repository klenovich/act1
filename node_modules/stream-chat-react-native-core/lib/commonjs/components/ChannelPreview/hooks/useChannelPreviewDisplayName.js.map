{"version":3,"names":["_react","require","_ChatContext","_utils","DEFAULT_MAX_CHARACTER_LENGTH","vw","ELLIPSIS","getMemberName","member","_member$user","_member$user2","user","name","id","getChannelPreviewDisplayName","_ref","channelName","characterLimit","currentUserId","members","channelMembers","Object","values","otherMembers","filter","_member$user3","sort","prevUser","nextUser","_prevUser$user$name","_prevUser$user","_nextUser$user$name","_nextUser$user","toLowerCase","localeCompare","toLocaleUpperCase","createChannelNameSuffix","remainingNumberOfMembers","length","slice","reduce","result","currentMember","index","originalArray","currentMemberName","resultHasSpaceForCurrentMemberName","truncateLimit","tuncatedCurrentMemberName","channelNameSuffix","exports","useChannelPreviewDisplayName","channel","characterLength","_channel$state","_channel$data","_useChatContext","useChatContext","client","userID","state","numOfMembers","keys","data","_useState","useState","_useState2","_slicedToArray2","displayName","setDisplayName","useEffect"],"sources":["useChannelPreviewDisplayName.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\n\nimport type { Channel, ChannelMemberResponse } from 'stream-chat';\n\nimport { useChatContext } from '../../../contexts/chatContext/ChatContext';\n\nimport type { DefaultStreamChatGenerics } from '../../../types/types';\nimport { vw } from '../../../utils/utils';\n\nconst DEFAULT_MAX_CHARACTER_LENGTH = (vw(100) - 16) / 6;\n\nconst ELLIPSIS = `...`;\n\nconst getMemberName = (member: ChannelMemberResponse) =>\n  member.user?.name || member.user?.id || 'Unknown User';\n\nexport const getChannelPreviewDisplayName = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>({\n  channelName,\n  characterLimit,\n  currentUserId,\n  members,\n}: {\n  characterLimit: number;\n  channelName?: string;\n  currentUserId?: string;\n  members?: Channel<StreamChatGenerics>['state']['members'];\n}): string => {\n  if (channelName) return channelName;\n\n  const channelMembers = Object.values(members || {});\n\n  const otherMembers = channelMembers.filter((member) => member.user?.id !== currentUserId);\n  otherMembers.sort((prevUser, nextUser) =>\n    (prevUser?.user?.name ?? '')\n      .toLowerCase()\n      .localeCompare((nextUser?.user?.name ?? '').toLocaleUpperCase()),\n  );\n\n  const createChannelNameSuffix = (remainingNumberOfMembers: number) =>\n    remainingNumberOfMembers <= 1 ? `${ELLIPSIS}` : `,${ELLIPSIS}+${remainingNumberOfMembers}`;\n\n  if (otherMembers.length === 1) {\n    const name = getMemberName(otherMembers[0]);\n    return name.length > characterLimit\n      ? `${name.slice(0, characterLimit - ELLIPSIS.length)}${ELLIPSIS}`\n      : name;\n  }\n\n  const name = otherMembers.reduce((result, currentMember, index, originalArray) => {\n    if (result.length >= characterLimit) {\n      return result;\n    }\n\n    const currentMemberName = getMemberName(currentMember);\n\n    const resultHasSpaceForCurrentMemberName =\n      result.length + (currentMemberName.length + ELLIPSIS.length) < characterLimit;\n\n    if (resultHasSpaceForCurrentMemberName) {\n      return result.length > 0 ? `${result}, ${currentMemberName}` : `${currentMemberName}`;\n    } else {\n      const remainingNumberOfMembers = originalArray.length - index;\n      const truncateLimit = characterLimit - (ELLIPSIS.length + result.length);\n      const tuncatedCurrentMemberName = `, ${currentMemberName.slice(0, truncateLimit)}`;\n\n      const channelNameSuffix = createChannelNameSuffix(remainingNumberOfMembers);\n\n      return `${result}${tuncatedCurrentMemberName}${channelNameSuffix}`;\n    }\n  }, '');\n\n  return name;\n};\n\nexport const useChannelPreviewDisplayName = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  channel?: Channel<StreamChatGenerics>,\n  characterLength?: number,\n) => {\n  const { client } = useChatContext<StreamChatGenerics>();\n\n  const currentUserId = client?.userID;\n  const members = channel?.state?.members;\n  const numOfMembers = Object.keys(members || {}).length;\n  const channelName = channel?.data?.name;\n  const characterLimit = characterLength || DEFAULT_MAX_CHARACTER_LENGTH;\n  const [displayName, setDisplayName] = useState(\n    getChannelPreviewDisplayName({\n      channelName,\n      characterLimit,\n      currentUserId,\n      members,\n    }),\n  );\n\n  useEffect(() => {\n    setDisplayName(\n      getChannelPreviewDisplayName({\n        channelName,\n        characterLimit,\n        currentUserId,\n        members,\n      }),\n    );\n  }, [channelName, currentUserId, characterLimit, numOfMembers]);\n\n  return displayName;\n};\n"],"mappings":"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"}