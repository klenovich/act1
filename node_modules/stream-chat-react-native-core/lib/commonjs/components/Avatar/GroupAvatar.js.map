{"version":3,"names":["_react","_interopRequireDefault","require","_reactNative","_ThemeContext","_useLoadingImage2","_getResizedImageUrl","_this","_jsxFileName","randomImageBaseUrl","randomSvgBaseUrl","streamCDN","styles","StyleSheet","create","container","overflow","flex","getInitials","fullName","split","slice","map","name","charAt","join","GroupAvatar","props","containerStyle","_props$ImageComponent","ImageComponent","Image","images","names","size","testID","_useTheme","useTheme","_useTheme$theme$group","theme","groupAvatar","image","_useLoadingImage","useLoadingImage","isLoadingImageError","setLoadingImageError","imagesOrNames","avatarImages","reduce","returnArray","currentImage","index","url","startsWith","length","concat","_toConsumableArray2","height","width","createElement","View","style","borderRadius","__self","__source","fileName","lineNumber","columnNumber","backgroundColor","column","colIndex","key","flexDirection","_ref","rowIndex","accessibilityLabel","onError","source","uri","includes","getResizedImageUrl","exports","displayName"],"sources":["GroupAvatar.tsx"],"sourcesContent":["import React from 'react';\nimport { Image, ImageProps, StyleProp, StyleSheet, View, ViewStyle } from 'react-native';\n\nimport { useTheme } from '../../contexts/themeContext/ThemeContext';\nimport { useLoadingImage } from '../../hooks/useLoadingImage';\nimport { getResizedImageUrl } from '../../utils/getResizedImageUrl';\nconst randomImageBaseUrl = 'https://getstream.io/random_png/';\nconst randomSvgBaseUrl = 'https://getstream.io/random_svg/';\nconst streamCDN = 'stream-io-cdn.com';\n\nconst styles = StyleSheet.create({\n  container: {\n    overflow: 'hidden',\n  },\n  flex: { flex: 1 },\n});\n\nconst getInitials = (fullName: string) =>\n  fullName\n    .split(' ')\n    .slice(0, 2)\n    .map((name) => name.charAt(0))\n    .join(' ');\n\nexport type GroupAvatarProps = {\n  /** total size in pixels */\n  size: number;\n  containerStyle?: StyleProp<ViewStyle>;\n  ImageComponent?: React.ComponentType<ImageProps>;\n  /** image urls */\n  images?: string[];\n  /** name of the users, used for fallback */\n  names?: string[];\n  testID?: string;\n};\n\n/**\n * GroupAvatar - A round group of avatar images with fallbacks to users' initials\n */\nexport const GroupAvatar: React.FC<GroupAvatarProps> = (props) => {\n  const { containerStyle, ImageComponent = Image, images, names, size, testID } = props;\n  const {\n    theme: {\n      groupAvatar: { container, image },\n    },\n  } = useTheme();\n\n  const { isLoadingImageError, setLoadingImageError } = useLoadingImage();\n  /**\n   * [\n   *    [\n   *        { height: number; name: string; url: string; width: number },\n   *        { height: number; name: string; url: string; width: number },\n   *    ],\n   *    [\n   *        { height: number; name: string; url: string; width: number },\n   *        { height: number; name: string; url: string; width: number },\n   *    ],\n   * ]\n   */\n  const imagesOrNames = images || names || [];\n  const avatarImages = imagesOrNames.slice(0, 4).reduce((returnArray, currentImage, index) => {\n    const url = currentImage.startsWith('http')\n      ? currentImage\n      : `${randomImageBaseUrl}${\n          names\n            ? `?name=${getInitials(names[index])}&size=${\n                imagesOrNames.length <= 2 ? size : size / 2\n              }`\n            : ''\n        }`;\n    if (imagesOrNames.length <= 2) {\n      returnArray[0] = [\n        ...(returnArray[0] || []),\n        {\n          height: imagesOrNames.length === 1 ? size : size / 2,\n          name: names ? names[index] : '',\n          url,\n          width: size,\n        },\n      ];\n    } else {\n      if (index < 2) {\n        returnArray[0] = [\n          ...(returnArray[0] || []),\n          {\n            height: size / 2,\n            name: names ? names[index] : '',\n            url,\n            width: size / 2,\n          },\n        ];\n      } else {\n        returnArray[1] = [\n          ...(returnArray[1] || []),\n          {\n            height: size / 2,\n            name: names ? names[index] : '',\n            url,\n            width: imagesOrNames.length === 3 ? size : size / 2,\n          },\n        ];\n      }\n    }\n    return returnArray;\n  }, [] as { height: number; name: string; url: string; width: number }[][]);\n\n  return (\n    <View\n      style={[\n        styles.container,\n        { borderRadius: size / 2, height: size, width: size },\n        container,\n        containerStyle,\n      ]}\n      testID={testID || 'group-avatar'}\n    >\n      {isLoadingImageError ? (\n        <View\n          style={{\n            backgroundColor: '#ececec',\n            borderRadius: size / 2,\n            height: size,\n            width: size,\n          }}\n        />\n      ) : (\n        avatarImages.map((column, colIndex) => (\n          <View\n            key={`avatar-column-${colIndex}`}\n            style={[\n              styles.flex,\n              {\n                flexDirection: imagesOrNames.length === 2 ? 'column' : 'row',\n              },\n            ]}\n          >\n            {column.map(({ height, name, url, width }, rowIndex) => (\n              <ImageComponent\n                accessibilityLabel={testID || 'Avatar Image'}\n                key={`avatar-${url}-${rowIndex}`}\n                onError={() => setLoadingImageError(true)}\n                source={{\n                  uri: url.includes(randomSvgBaseUrl)\n                    ? url.includes(streamCDN)\n                      ? url\n                      : `${randomImageBaseUrl}${\n                          name ? `?name=${getInitials(name)}&size=${height}` : ''\n                        }`\n                    : getResizedImageUrl({\n                        height,\n                        url,\n                        width,\n                      }),\n                }}\n                style={[\n                  image,\n                  size\n                    ? {\n                        backgroundColor: '#ececec',\n                        height,\n                        width,\n                      }\n                    : {},\n                ]}\n                testID={`group-avatar-image-${colIndex}-${rowIndex}`}\n              />\n            ))}\n          </View>\n        ))\n      )}\n    </View>\n  );\n};\n\nGroupAvatar.displayName = 'GroupAvatar{groupAvatar}';\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,YAAA,GAAAD,OAAA;AAEA,IAAAE,aAAA,GAAAF,OAAA;AACA,IAAAG,iBAAA,GAAAH,OAAA;AACA,IAAAI,mBAAA,GAAAJ,OAAA;AAAoE,IAAAK,KAAA;EAAAC,YAAA;AACpE,IAAMC,kBAAkB,GAAG,kCAAkC;AAC7D,IAAMC,gBAAgB,GAAG,kCAAkC;AAC3D,IAAMC,SAAS,GAAG,mBAAmB;AAErC,IAAMC,MAAM,GAAGC,uBAAU,CAACC,MAAM,CAAC;EAC/BC,SAAS,EAAE;IACTC,QAAQ,EAAE;EACZ,CAAC;EACDC,IAAI,EAAE;IAAEA,IAAI,EAAE;EAAE;AAClB,CAAC,CAAC;AAEF,IAAMC,WAAW,GAAG,SAAdA,WAAWA,CAAIC,QAAgB;EAAA,OACnCA,QAAQ,CACLC,KAAK,CAAC,GAAG,CAAC,CACVC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CACXC,GAAG,CAAC,UAACC,IAAI;IAAA,OAAKA,IAAI,CAACC,MAAM,CAAC,CAAC,CAAC;EAAA,EAAC,CAC7BC,IAAI,CAAC,GAAG,CAAC;AAAA;AAiBP,IAAMC,WAAuC,GAAG,SAA1CA,WAAuCA,CAAIC,KAAK,EAAK;EAChE,IAAQC,cAAc,GAA0DD,KAAK,CAA7EC,cAAc;IAAAC,qBAAA,GAA0DF,KAAK,CAA7DG,cAAc;IAAdA,cAAc,GAAAD,qBAAA,cAAGE,kBAAK,GAAAF,qBAAA;IAAEG,MAAM,GAA0BL,KAAK,CAArCK,MAAM;IAAEC,KAAK,GAAmBN,KAAK,CAA7BM,KAAK;IAAEC,IAAI,GAAaP,KAAK,CAAtBO,IAAI;IAAEC,MAAM,GAAKR,KAAK,CAAhBQ,MAAM;EAC3E,IAAAC,SAAA,GAII,IAAAC,sBAAQ,EAAC,CAAC;IAAAC,qBAAA,GAAAF,SAAA,CAHZG,KAAK,CACHC,WAAW;IAAIzB,SAAS,GAAAuB,qBAAA,CAATvB,SAAS;IAAE0B,KAAK,GAAAH,qBAAA,CAALG,KAAK;EAInC,IAAAC,gBAAA,GAAsD,IAAAC,iCAAe,EAAC,CAAC;IAA/DC,mBAAmB,GAAAF,gBAAA,CAAnBE,mBAAmB;IAAEC,oBAAoB,GAAAH,gBAAA,CAApBG,oBAAoB;EAajD,IAAMC,aAAa,GAAGd,MAAM,IAAIC,KAAK,IAAI,EAAE;EAC3C,IAAMc,YAAY,GAAGD,aAAa,CAACzB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC2B,MAAM,CAAC,UAACC,WAAW,EAAEC,YAAY,EAAEC,KAAK,EAAK;IAC1F,IAAMC,GAAG,GAAGF,YAAY,CAACG,UAAU,CAAC,MAAM,CAAC,GACvCH,YAAY,QACTzC,kBAAkB,IACnBwB,KAAK,cACQf,WAAW,CAACe,KAAK,CAACkB,KAAK,CAAC,CAAC,eAChCL,aAAa,CAACQ,MAAM,IAAI,CAAC,GAAGpB,IAAI,GAAGA,IAAI,GAAG,CAAC,IAE7C,EAAE,CACN;IACN,IAAIY,aAAa,CAACQ,MAAM,IAAI,CAAC,EAAE;MAC7BL,WAAW,CAAC,CAAC,CAAC,MAAAM,MAAA,KAAAC,mBAAA,aACRP,WAAW,CAAC,CAAC,CAAC,IAAI,EAAE,IACxB;QACEQ,MAAM,EAAEX,aAAa,CAACQ,MAAM,KAAK,CAAC,GAAGpB,IAAI,GAAGA,IAAI,GAAG,CAAC;QACpDX,IAAI,EAAEU,KAAK,GAAGA,KAAK,CAACkB,KAAK,CAAC,GAAG,EAAE;QAC/BC,GAAG,EAAHA,GAAG;QACHM,KAAK,EAAExB;MACT,CAAC,EACF;IACH,CAAC,MAAM;MACL,IAAIiB,KAAK,GAAG,CAAC,EAAE;QACbF,WAAW,CAAC,CAAC,CAAC,MAAAM,MAAA,KAAAC,mBAAA,aACRP,WAAW,CAAC,CAAC,CAAC,IAAI,EAAE,IACxB;UACEQ,MAAM,EAAEvB,IAAI,GAAG,CAAC;UAChBX,IAAI,EAAEU,KAAK,GAAGA,KAAK,CAACkB,KAAK,CAAC,GAAG,EAAE;UAC/BC,GAAG,EAAHA,GAAG;UACHM,KAAK,EAAExB,IAAI,GAAG;QAChB,CAAC,EACF;MACH,CAAC,MAAM;QACLe,WAAW,CAAC,CAAC,CAAC,MAAAM,MAAA,KAAAC,mBAAA,aACRP,WAAW,CAAC,CAAC,CAAC,IAAI,EAAE,IACxB;UACEQ,MAAM,EAAEvB,IAAI,GAAG,CAAC;UAChBX,IAAI,EAAEU,KAAK,GAAGA,KAAK,CAACkB,KAAK,CAAC,GAAG,EAAE;UAC/BC,GAAG,EAAHA,GAAG;UACHM,KAAK,EAAEZ,aAAa,CAACQ,MAAM,KAAK,CAAC,GAAGpB,IAAI,GAAGA,IAAI,GAAG;QACpD,CAAC,EACF;MACH;IACF;IACA,OAAOe,WAAW;EACpB,CAAC,EAAE,EAAsE,CAAC;EAE1E,OACEjD,MAAA,YAAA2D,aAAA,CAACxD,YAAA,CAAAyD,IAAI;IACHC,KAAK,EAAE,CACLjD,MAAM,CAACG,SAAS,EAChB;MAAE+C,YAAY,EAAE5B,IAAI,GAAG,CAAC;MAAEuB,MAAM,EAAEvB,IAAI;MAAEwB,KAAK,EAAExB;IAAK,CAAC,EACrDnB,SAAS,EACTa,cAAc,CACd;IACFO,MAAM,EAAEA,MAAM,IAAI,cAAe;IAAA4B,MAAA,EAAAxD,KAAA;IAAAyD,QAAA;MAAAC,QAAA,EAAAzD,YAAA;MAAA0D,UAAA;MAAAC,YAAA;IAAA;EAAA,GAEhCvB,mBAAmB,GAClB5C,MAAA,YAAA2D,aAAA,CAACxD,YAAA,CAAAyD,IAAI;IACHC,KAAK,EAAE;MACLO,eAAe,EAAE,SAAS;MAC1BN,YAAY,EAAE5B,IAAI,GAAG,CAAC;MACtBuB,MAAM,EAAEvB,IAAI;MACZwB,KAAK,EAAExB;IACT,CAAE;IAAA6B,MAAA,EAAAxD,KAAA;IAAAyD,QAAA;MAAAC,QAAA,EAAAzD,YAAA;MAAA0D,UAAA;MAAAC,YAAA;IAAA;EAAA,CACH,CAAC,GAEFpB,YAAY,CAACzB,GAAG,CAAC,UAAC+C,MAAM,EAAEC,QAAQ;IAAA,OAChCtE,MAAA,YAAA2D,aAAA,CAACxD,YAAA,CAAAyD,IAAI;MACHW,GAAG,qBAAmBD,QAAW;MACjCT,KAAK,EAAE,CACLjD,MAAM,CAACK,IAAI,EACX;QACEuD,aAAa,EAAE1B,aAAa,CAACQ,MAAM,KAAK,CAAC,GAAG,QAAQ,GAAG;MACzD,CAAC,CACD;MAAAS,MAAA,EAAAxD,KAAA;MAAAyD,QAAA;QAAAC,QAAA,EAAAzD,YAAA;QAAA0D,UAAA;QAAAC,YAAA;MAAA;IAAA,GAEDE,MAAM,CAAC/C,GAAG,CAAC,UAAAmD,IAAA,EAA+BC,QAAQ;MAAA,IAApCjB,MAAM,GAAAgB,IAAA,CAANhB,MAAM;QAAElC,IAAI,GAAAkD,IAAA,CAAJlD,IAAI;QAAE6B,GAAG,GAAAqB,IAAA,CAAHrB,GAAG;QAAEM,KAAK,GAAAe,IAAA,CAALf,KAAK;MAAA,OACrC1D,MAAA,YAAA2D,aAAA,CAAC7B,cAAc;QACb6C,kBAAkB,EAAExC,MAAM,IAAI,cAAe;QAC7CoC,GAAG,cAAYnB,GAAG,SAAIsB,QAAW;QACjCE,OAAO,EAAE,SAAAA,QAAA;UAAA,OAAM/B,oBAAoB,CAAC,IAAI,CAAC;QAAA,CAAC;QAC1CgC,MAAM,EAAE;UACNC,GAAG,EAAE1B,GAAG,CAAC2B,QAAQ,CAACrE,gBAAgB,CAAC,GAC/B0C,GAAG,CAAC2B,QAAQ,CAACpE,SAAS,CAAC,GACrByC,GAAG,QACA3C,kBAAkB,IACnBc,IAAI,cAAYL,WAAW,CAACK,IAAI,CAAC,cAASkC,MAAM,GAAK,EAAE,CACvD,GACJ,IAAAuB,sCAAkB,EAAC;YACjBvB,MAAM,EAANA,MAAM;YACNL,GAAG,EAAHA,GAAG;YACHM,KAAK,EAALA;UACF,CAAC;QACP,CAAE;QACFG,KAAK,EAAE,CACLpB,KAAK,EACLP,IAAI,GACA;UACEkC,eAAe,EAAE,SAAS;UAC1BX,MAAM,EAANA,MAAM;UACNC,KAAK,EAALA;QACF,CAAC,GACD,CAAC,CAAC,CACN;QACFvB,MAAM,0BAAwBmC,QAAQ,SAAII,QAAW;QAAAX,MAAA,EAAAxD,KAAA;QAAAyD,QAAA;UAAAC,QAAA,EAAAzD,YAAA;UAAA0D,UAAA;UAAAC,YAAA;QAAA;MAAA,CACtD,CAAC;IAAA,CACH,CACG,CAAC;EAAA,CACR,CAEC,CAAC;AAEX,CAAC;AAACc,OAAA,CAAAvD,WAAA,GAAAA,WAAA;AAEFA,WAAW,CAACwD,WAAW,GAAG,0BAA0B"}