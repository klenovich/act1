{"version":3,"names":["_react","require","dbApi","_interopRequireWildcard","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","_typeof","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","useAppSettings","client","isOnline","enableOfflineSupport","initialisedDatabase","_useState","useState","_useState2","_slicedToArray2","appSettings","setAppSettings","isMounted","useRef","useEffect","enforeAppSettings","_enforeAppSettings","apply","arguments","_asyncToGenerator2","_regenerator","mark","_callee","_appSettings","_appSettings2","wrap","_callee$","_context","prev","next","userID","abrupt","getAppSettings","currentUserId","sent","current","upsertAppSettings","t0","Error","console","error","stop","exports"],"sources":["useAppSettings.ts"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\n\nimport type { AppSettingsAPIResponse, StreamChat } from 'stream-chat';\n\nimport * as dbApi from '../../../store/apis';\nimport type { DefaultStreamChatGenerics } from '../../../types/types';\nexport const useAppSettings = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  client: StreamChat<StreamChatGenerics>,\n  isOnline: boolean | null,\n  enableOfflineSupport: boolean,\n  initialisedDatabase: boolean,\n): AppSettingsAPIResponse | null => {\n  const [appSettings, setAppSettings] = useState<AppSettingsAPIResponse | null>(null);\n  const isMounted = useRef(true);\n\n  useEffect(() => {\n    async function enforeAppSettings() {\n      if (!client.userID) return;\n\n      if (!isOnline && enableOfflineSupport && initialisedDatabase) {\n        const appSettings = dbApi.getAppSettings({ currentUserId: client.userID });\n        setAppSettings(appSettings);\n        return;\n      }\n\n      try {\n        const appSettings = await client.getAppSettings();\n        if (isMounted.current) {\n          setAppSettings(appSettings);\n          enableOfflineSupport &&\n            dbApi.upsertAppSettings({\n              appSettings,\n              currentUserId: client.userID as string,\n            });\n        }\n      } catch (error: unknown) {\n        if (error instanceof Error) {\n          console.error(`An error occurred while getting app settings: ${error}`);\n        }\n      }\n    }\n\n    enforeAppSettings();\n\n    return () => {\n      isMounted.current = false;\n    };\n  }, [client, isOnline, initialisedDatabase]);\n\n  return appSettings;\n};\n"],"mappings":"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"}