{"version":3,"names":["_react","_interopRequireDefault","require","_AttachmentActions","_Card","_FileAttachment","_Gallery","_Giphy","_MessagesContext","_native","_this","_jsxFileName","AttachmentWithContext","props","_attachment$actions","attachment","AttachmentActions","Card","FileAttachment","Gallery","Giphy","giphyVersion","UrlPreview","hasAttachmentActions","actions","length","type","createElement","__self","__source","fileName","lineNumber","columnNumber","og_scrape_url","title_link","_extends2","Fragment","images","key","id","isVideoPackageAvailable","videos","areEqual","prevProps","nextProps","_prevAttachment$actio","_nextAttachment$actio","prevAttachment","isAttachmentEqual","nextAttachment","attachmentEqual","image_url","thumb_url","MemoizedAttachment","React","memo","Attachment","PropAttachmentActions","PropCard","PropFileAttachment","PropGallery","PropGiphy","PropGiphyVersion","PropUrlPreview","_useMessagesContext","useMessagesContext","ContextAttachmentActions","ContextCard","ContextFileAttachment","ContextGallery","ContextGiphy","ContextGiphyVersion","ContextUrlPreview","AttachmentActionsDefault","CardDefault","FileAttachmentDefault","GalleryDefault","GiphyDefault","exports"],"sources":["Attachment.tsx"],"sourcesContent":["import React from 'react';\n\nimport type { Attachment as AttachmentType } from 'stream-chat';\n\nimport { AttachmentActions as AttachmentActionsDefault } from '../../components/Attachment/AttachmentActions';\nimport { Card as CardDefault } from '../../components/Attachment/Card';\nimport { FileAttachment as FileAttachmentDefault } from '../../components/Attachment/FileAttachment';\nimport { Gallery as GalleryDefault } from '../../components/Attachment/Gallery';\nimport { Giphy as GiphyDefault } from '../../components/Attachment/Giphy';\nimport {\n  MessagesContextValue,\n  useMessagesContext,\n} from '../../contexts/messagesContext/MessagesContext';\nimport { isVideoPackageAvailable } from '../../native';\n\nimport type { DefaultStreamChatGenerics } from '../../types/types';\n\nexport type ActionHandler = (name: string, value: string) => void;\n\nexport type AttachmentPropsWithContext<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n> = Pick<\n  MessagesContextValue<StreamChatGenerics>,\n  | 'AttachmentActions'\n  | 'Card'\n  | 'FileAttachment'\n  | 'Gallery'\n  | 'giphyVersion'\n  | 'Giphy'\n  | 'isAttachmentEqual'\n  | 'UrlPreview'\n> & {\n  /**\n   * The attachment to render\n   */\n  attachment: AttachmentType<StreamChatGenerics>;\n};\n\nconst AttachmentWithContext = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  props: AttachmentPropsWithContext<StreamChatGenerics>,\n) => {\n  const {\n    attachment,\n    AttachmentActions,\n    Card,\n    FileAttachment,\n    Gallery,\n    Giphy,\n    giphyVersion,\n    UrlPreview,\n  } = props;\n\n  const hasAttachmentActions = !!attachment.actions?.length;\n\n  if (attachment.type === 'giphy' || attachment.type === 'imgur') {\n    return <Giphy attachment={attachment} giphyVersion={giphyVersion} />;\n  }\n\n  if (attachment.og_scrape_url || attachment.title_link) {\n    return <UrlPreview {...attachment} />;\n  }\n\n  if (attachment.type === 'image') {\n    return (\n      <>\n        <Gallery images={[attachment]} />\n        {hasAttachmentActions && (\n          <AttachmentActions key={`key-actions-${attachment.id}`} {...attachment} />\n        )}\n      </>\n    );\n  }\n\n  if (attachment.type === 'video' && !attachment.og_scrape_url) {\n    return isVideoPackageAvailable() ? (\n      <>\n        <Gallery videos={[attachment]} />\n        {hasAttachmentActions && (\n          <AttachmentActions key={`key-actions-${attachment.id}`} {...attachment} />\n        )}\n      </>\n    ) : (\n      <FileAttachment attachment={attachment} />\n    );\n  }\n\n  if (attachment.type === 'file' || attachment.type === 'audio') {\n    return <FileAttachment attachment={attachment} />;\n  }\n\n  if (hasAttachmentActions) {\n    return (\n      <>\n        <Card {...attachment} />\n        <AttachmentActions key={`key-actions-${attachment.id}`} {...attachment} />\n      </>\n    );\n  } else {\n    return <Card {...attachment} />;\n  }\n};\n\nconst areEqual = <StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics>(\n  prevProps: AttachmentPropsWithContext<StreamChatGenerics>,\n  nextProps: AttachmentPropsWithContext<StreamChatGenerics>,\n) => {\n  const { attachment: prevAttachment, isAttachmentEqual } = prevProps;\n  const { attachment: nextAttachment } = nextProps;\n\n  const attachmentEqual =\n    prevAttachment.actions?.length === nextAttachment.actions?.length &&\n    prevAttachment.image_url === nextAttachment.image_url &&\n    prevAttachment.thumb_url === nextAttachment.thumb_url;\n  if (!attachmentEqual) return false;\n\n  if (isAttachmentEqual) {\n    return isAttachmentEqual(prevAttachment, nextAttachment);\n  }\n\n  return true;\n};\n\nconst MemoizedAttachment = React.memo(\n  AttachmentWithContext,\n  areEqual,\n) as typeof AttachmentWithContext;\n\nexport type AttachmentProps<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n> = Partial<\n  Pick<\n    MessagesContextValue<StreamChatGenerics>,\n    | 'AttachmentActions'\n    | 'Card'\n    | 'FileAttachment'\n    | 'Gallery'\n    | 'Giphy'\n    | 'giphyVersion'\n    | 'UrlPreview'\n    | 'isAttachmentEqual'\n  >\n> &\n  Pick<AttachmentPropsWithContext<StreamChatGenerics>, 'attachment'>;\n\n/**\n * Attachment - The message attachment\n */\nexport const Attachment = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  props: AttachmentProps<StreamChatGenerics>,\n) => {\n  const {\n    attachment,\n    AttachmentActions: PropAttachmentActions,\n    Card: PropCard,\n    FileAttachment: PropFileAttachment,\n    Gallery: PropGallery,\n    Giphy: PropGiphy,\n    giphyVersion: PropGiphyVersion,\n    UrlPreview: PropUrlPreview,\n  } = props;\n\n  const {\n    AttachmentActions: ContextAttachmentActions,\n    Card: ContextCard,\n    FileAttachment: ContextFileAttachment,\n    Gallery: ContextGallery,\n    Giphy: ContextGiphy,\n    giphyVersion: ContextGiphyVersion,\n    isAttachmentEqual,\n    UrlPreview: ContextUrlPreview,\n  } = useMessagesContext<StreamChatGenerics>();\n\n  if (!attachment) {\n    return null;\n  }\n\n  const AttachmentActions =\n    PropAttachmentActions || ContextAttachmentActions || AttachmentActionsDefault;\n  const Card = PropCard || ContextCard || CardDefault;\n  const FileAttachment = PropFileAttachment || ContextFileAttachment || FileAttachmentDefault;\n  const Gallery = PropGallery || ContextGallery || GalleryDefault;\n  const Giphy = PropGiphy || ContextGiphy || GiphyDefault;\n  const UrlPreview = PropUrlPreview || ContextUrlPreview || CardDefault;\n  const giphyVersion = PropGiphyVersion || ContextGiphyVersion;\n\n  return (\n    <MemoizedAttachment\n      {...{\n        attachment,\n        AttachmentActions,\n        Card,\n        FileAttachment,\n        Gallery,\n        Giphy,\n        giphyVersion,\n        isAttachmentEqual,\n        UrlPreview,\n      }}\n    />\n  );\n};\n"],"mappings":"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"}