{"version":3,"names":["_buildThumbnailGrid","require","_getAspectRatio","moveToFront","array","item","index","indexOf","newArray","_toConsumableArray2","splice","unshift","buildGalleryOfThreeImages","_ref","images","sizeConfig","_images$reduce","reduce","acc","image","aspectRatio","getAspectRatio","o","_extends2","landscapeImage","landscapeImageAspectRatio","portraitImage","portraitImageAspectRatio","buildThumbnailGrid","grid","invertedDirections"],"sources":["buildGalleryOfThreeImages.ts"],"sourcesContent":["import type { Attachment } from 'stream-chat';\n\nimport { buildThumbnailGrid } from './buildThumbnailGrid';\n\nimport type { GallerySizeAndThumbnailGrid, GallerySizeConfig } from './types';\n\nimport type { DefaultStreamChatGenerics } from '../../../../types/types';\nimport { getAspectRatio } from '../getAspectRatio';\n\n/** function to move item to the front of the array */\nfunction moveToFront<T>(array: T[], item: T): T[] {\n  const index = array.indexOf(item);\n  if (index === -1) {\n    return array;\n  }\n  const newArray = [...array];\n  newArray.splice(index, 1);\n  newArray.unshift(item);\n  return newArray;\n}\n\nexport function buildGalleryOfThreeImages<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>({\n  images,\n  sizeConfig,\n}: {\n  images: Attachment<StreamChatGenerics>[];\n  sizeConfig: GallerySizeConfig;\n}): GallerySizeAndThumbnailGrid {\n  // Find the most ladscape and most portrait image.\n  const { landscapeImage, landscapeImageAspectRatio, portraitImage, portraitImageAspectRatio } =\n    images.reduce(\n      (acc, image) => {\n        const aspectRatio = getAspectRatio(image);\n        const o = { ...acc };\n\n        // Following nested if conditions can be combined, but have been kept\n        // separate intentionally for the sake of readability.\n        if (aspectRatio > 1) {\n          if (!o.landscapeImage || aspectRatio > o.landscapeImageAspectRatio) {\n            o.landscapeImage = image;\n            o.landscapeImageAspectRatio = aspectRatio;\n          }\n        } else {\n          if (!o.portraitImage || aspectRatio < o.portraitImageAspectRatio) {\n            o.portraitImage = image;\n            o.portraitImageAspectRatio = aspectRatio;\n          }\n        }\n\n        return o;\n      },\n      {\n        landscapeImageAspectRatio: 1,\n        portraitImageAspectRatio: 1,\n      } as {\n        landscapeImage: Attachment<StreamChatGenerics>;\n        landscapeImageAspectRatio: number;\n        portraitImage: Attachment<StreamChatGenerics>;\n        portraitImageAspectRatio: number;\n      },\n    );\n\n  // Check weather landscape image gets preference or portrait, by comparing aspect ratio.\n  if (landscapeImageAspectRatio > 1 / portraitImageAspectRatio) {\n    /**\n     * -----------\n     * |         |\n     * |         |\n     * |---------|\n     * |    |    |\n     * |    |    |\n     * -----------\n     */\n    return buildThumbnailGrid({\n      grid: [[1], [1, 1]],\n      images: landscapeImage ? moveToFront(images, landscapeImage) : images,\n      invertedDirections: true,\n      sizeConfig,\n    });\n  } else {\n    /**\n     * -----------\n     * |    |    |\n     * |    |    |\n     * |    |----|\n     * |    |    |\n     * |    |    |\n     * -----------\n     */\n    return buildThumbnailGrid({\n      grid: [[1], [1, 1]],\n      images: portraitImage ? moveToFront(images, portraitImage) : images,\n      invertedDirections: false,\n      sizeConfig,\n    });\n  }\n}\n"],"mappings":";;;;;;;AAEA,IAAAA,mBAAA,GAAAC,OAAA;AAKA,IAAAC,eAAA,GAAAD,OAAA;AAGA,SAASE,WAAWA,CAAIC,KAAU,EAAEC,IAAO,EAAO;EAChD,IAAMC,KAAK,GAAGF,KAAK,CAACG,OAAO,CAACF,IAAI,CAAC;EACjC,IAAIC,KAAK,KAAK,CAAC,CAAC,EAAE;IAChB,OAAOF,KAAK;EACd;EACA,IAAMI,QAAQ,OAAAC,mBAAA,aAAOL,KAAK,CAAC;EAC3BI,QAAQ,CAACE,MAAM,CAACJ,KAAK,EAAE,CAAC,CAAC;EACzBE,QAAQ,CAACG,OAAO,CAACN,IAAI,CAAC;EACtB,OAAOG,QAAQ;AACjB;AAEO,SAASI,yBAAyBA,CAAAC,IAAA,EAQT;EAAA,IAL9BC,MAAM,GAAAD,IAAA,CAANC,MAAM;IACNC,UAAU,GAAAF,IAAA,CAAVE,UAAU;EAMV,IAAAC,cAAA,GACEF,MAAM,CAACG,MAAM,CACX,UAACC,GAAG,EAAEC,KAAK,EAAK;MACd,IAAMC,WAAW,GAAG,IAAAC,8BAAc,EAACF,KAAK,CAAC;MACzC,IAAMG,CAAC,OAAAC,SAAA,iBAAQL,GAAG,CAAE;MAIpB,IAAIE,WAAW,GAAG,CAAC,EAAE;QACnB,IAAI,CAACE,CAAC,CAACE,cAAc,IAAIJ,WAAW,GAAGE,CAAC,CAACG,yBAAyB,EAAE;UAClEH,CAAC,CAACE,cAAc,GAAGL,KAAK;UACxBG,CAAC,CAACG,yBAAyB,GAAGL,WAAW;QAC3C;MACF,CAAC,MAAM;QACL,IAAI,CAACE,CAAC,CAACI,aAAa,IAAIN,WAAW,GAAGE,CAAC,CAACK,wBAAwB,EAAE;UAChEL,CAAC,CAACI,aAAa,GAAGP,KAAK;UACvBG,CAAC,CAACK,wBAAwB,GAAGP,WAAW;QAC1C;MACF;MAEA,OAAOE,CAAC;IACV,CAAC,EACD;MACEG,yBAAyB,EAAE,CAAC;MAC5BE,wBAAwB,EAAE;IAC5B,CAMF,CAAC;IA/BKH,cAAc,GAAAR,cAAA,CAAdQ,cAAc;IAAEC,yBAAyB,GAAAT,cAAA,CAAzBS,yBAAyB;IAAEC,aAAa,GAAAV,cAAA,CAAbU,aAAa;IAAEC,wBAAwB,GAAAX,cAAA,CAAxBW,wBAAwB;EAkC1F,IAAIF,yBAAyB,GAAG,CAAC,GAAGE,wBAAwB,EAAE;IAU5D,OAAO,IAAAC,sCAAkB,EAAC;MACxBC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;MACnBf,MAAM,EAAEU,cAAc,GAAGrB,WAAW,CAACW,MAAM,EAAEU,cAAc,CAAC,GAAGV,MAAM;MACrEgB,kBAAkB,EAAE,IAAI;MACxBf,UAAU,EAAVA;IACF,CAAC,CAAC;EACJ,CAAC,MAAM;IAUL,OAAO,IAAAa,sCAAkB,EAAC;MACxBC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;MACnBf,MAAM,EAAEY,aAAa,GAAGvB,WAAW,CAACW,MAAM,EAAEY,aAAa,CAAC,GAAGZ,MAAM;MACnEgB,kBAAkB,EAAE,KAAK;MACzBf,UAAU,EAAVA;IACF,CAAC,CAAC;EACJ;AACF"}