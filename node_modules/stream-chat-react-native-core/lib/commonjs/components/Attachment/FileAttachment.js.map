{"version":3,"names":["_react","_interopRequireDefault","require","_reactNative","_openUrlSafely","_AttachmentActions","_FileIcon","_MessageContext","_MessagesContext","_ThemeContext","_utils","_this","_jsxFileName","styles","StyleSheet","create","container","alignItems","borderRadius","flexDirection","padding","details","maxWidth","vw","paddingLeft","size","fontSize","title","fontWeight","FileAttachmentWithContext","props","_attachment$actions","additionalTouchableProps","attachment","attachmentSize","AttachmentActions","FileAttachmentIcon","onLongPress","onPress","onPressIn","preventPress","_props$styles","stylesProp","_useTheme","useTheme","_useTheme$theme","theme","_useTheme$theme$color","colors","black","grey","white","_useTheme$theme$messa","messageSimple","file","fileSize","defaultOnPress","openUrlSafely","asset_url","createElement","TouchableOpacity","_extends2","disabled","event","additionalInfo","emitter","defaultHandler","testID","__self","__source","fileName","lineNumber","columnNumber","View","style","backgroundColor","mimeType","mime_type","Text","numberOfLines","color","getFileSizeDisplayText","file_size","actions","length","FileAttachment","_useMessageContext","useMessageContext","_useMessagesContext","useMessagesContext","_useMessagesContext$A","AttachmentActionsDefault","_useMessagesContext$F","FileIconDefault","exports","parseFloat","Math","floor","displayName"],"sources":["FileAttachment.tsx"],"sourcesContent":["import React from 'react';\nimport {\n  StyleProp,\n  StyleSheet,\n  Text,\n  TextStyle,\n  TouchableOpacity,\n  View,\n  ViewStyle,\n} from 'react-native';\n\nimport type { Attachment } from 'stream-chat';\n\nimport { openUrlSafely } from './utils/openUrlSafely';\n\nimport { AttachmentActions as AttachmentActionsDefault } from '../../components/Attachment/AttachmentActions';\nimport { FileIcon as FileIconDefault } from '../../components/Attachment/FileIcon';\nimport {\n  MessageContextValue,\n  useMessageContext,\n} from '../../contexts/messageContext/MessageContext';\nimport {\n  MessagesContextValue,\n  useMessagesContext,\n} from '../../contexts/messagesContext/MessagesContext';\nimport { useTheme } from '../../contexts/themeContext/ThemeContext';\nimport type { DefaultStreamChatGenerics } from '../../types/types';\nimport { vw } from '../../utils/utils';\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    borderRadius: 12,\n    flexDirection: 'row',\n    padding: 8,\n  },\n  details: {\n    maxWidth: vw(60),\n    paddingLeft: 16,\n  },\n  size: {\n    fontSize: 12,\n  },\n  title: {\n    fontSize: 14,\n    fontWeight: '700',\n  },\n});\n\nexport type FileAttachmentPropsWithContext<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n> = Pick<\n  MessageContextValue<StreamChatGenerics>,\n  'onLongPress' | 'onPress' | 'onPressIn' | 'preventPress'\n> &\n  Pick<\n    MessagesContextValue<StreamChatGenerics>,\n    'additionalTouchableProps' | 'AttachmentActions' | 'FileAttachmentIcon'\n  > & {\n    /** The attachment to render */\n    attachment: Attachment<StreamChatGenerics>;\n    attachmentSize?: number;\n    styles?: Partial<{\n      container: StyleProp<ViewStyle>;\n      details: StyleProp<ViewStyle>;\n      size: StyleProp<TextStyle>;\n      title: StyleProp<TextStyle>;\n    }>;\n  };\n\nconst FileAttachmentWithContext = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  props: FileAttachmentPropsWithContext<StreamChatGenerics>,\n) => {\n  const {\n    additionalTouchableProps,\n    attachment,\n    attachmentSize,\n    AttachmentActions,\n    FileAttachmentIcon,\n    onLongPress,\n    onPress,\n    onPressIn,\n    preventPress,\n    styles: stylesProp = {},\n  } = props;\n\n  const {\n    theme: {\n      colors: { black, grey, white },\n      messageSimple: {\n        file: { container, details, fileSize, title },\n      },\n    },\n  } = useTheme();\n\n  const defaultOnPress = () => openUrlSafely(attachment.asset_url);\n\n  return (\n    <TouchableOpacity\n      disabled={preventPress}\n      onLongPress={(event) => {\n        if (onLongPress) {\n          onLongPress({\n            additionalInfo: { attachment },\n            emitter: 'fileAttachment',\n            event,\n          });\n        }\n      }}\n      onPress={(event) => {\n        if (onPress) {\n          onPress({\n            additionalInfo: { attachment },\n            defaultHandler: defaultOnPress,\n            emitter: 'fileAttachment',\n            event,\n          });\n        }\n      }}\n      onPressIn={(event) => {\n        if (onPressIn) {\n          onPressIn({\n            additionalInfo: { attachment },\n            defaultHandler: defaultOnPress,\n            emitter: 'fileAttachment',\n            event,\n          });\n        }\n      }}\n      testID='file-attachment'\n      {...additionalTouchableProps}\n    >\n      <View style={[styles.container, { backgroundColor: white }, container, stylesProp.container]}>\n        <FileAttachmentIcon mimeType={attachment.mime_type} size={attachmentSize} />\n        <View style={[styles.details, details, stylesProp.details]}>\n          <Text numberOfLines={2} style={[styles.title, { color: black }, title, stylesProp.title]}>\n            {attachment.title}\n          </Text>\n          <Text style={[styles.size, { color: grey }, fileSize, stylesProp.size]}>\n            {getFileSizeDisplayText(attachment.file_size)}\n          </Text>\n        </View>\n      </View>\n      {attachment.actions?.length ? <AttachmentActions {...attachment} /> : null}\n    </TouchableOpacity>\n  );\n};\n\nexport type FileAttachmentProps<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n> = Partial<Omit<FileAttachmentPropsWithContext<StreamChatGenerics>, 'attachment'>> &\n  Pick<FileAttachmentPropsWithContext<StreamChatGenerics>, 'attachment'>;\n\nexport const FileAttachment = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  props: FileAttachmentProps<StreamChatGenerics>,\n) => {\n  const { onLongPress, onPress, onPressIn, preventPress } = useMessageContext<StreamChatGenerics>();\n  const {\n    additionalTouchableProps,\n    AttachmentActions = AttachmentActionsDefault,\n    FileAttachmentIcon = FileIconDefault,\n  } = useMessagesContext<StreamChatGenerics>();\n\n  return (\n    <FileAttachmentWithContext\n      {...{\n        additionalTouchableProps,\n        AttachmentActions,\n        FileAttachmentIcon,\n        onLongPress,\n        onPress,\n        onPressIn,\n        preventPress,\n      }}\n      {...props}\n    />\n  );\n};\n\nexport const getFileSizeDisplayText = (size?: number | string) => {\n  if (!size) return;\n  if (typeof size === 'string') {\n    size = parseFloat(size);\n  }\n\n  if (size < 1000 * 1000) {\n    return `${Math.floor(Math.floor(size / 10) / 100)} KB`;\n  }\n\n  return `${Math.floor(Math.floor(size / 10000) / 100)} MB`;\n};\n\nFileAttachment.displayName = 'FileAttachment{messageSimple{file}}';\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,YAAA,GAAAD,OAAA;AAYA,IAAAE,cAAA,GAAAF,OAAA;AAEA,IAAAG,kBAAA,GAAAH,OAAA;AACA,IAAAI,SAAA,GAAAJ,OAAA;AACA,IAAAK,eAAA,GAAAL,OAAA;AAIA,IAAAM,gBAAA,GAAAN,OAAA;AAIA,IAAAO,aAAA,GAAAP,OAAA;AAEA,IAAAQ,MAAA,GAAAR,OAAA;AAAuC,IAAAS,KAAA;EAAAC,YAAA;AAEvC,IAAMC,MAAM,GAAGC,uBAAU,CAACC,MAAM,CAAC;EAC/BC,SAAS,EAAE;IACTC,UAAU,EAAE,QAAQ;IACpBC,YAAY,EAAE,EAAE;IAChBC,aAAa,EAAE,KAAK;IACpBC,OAAO,EAAE;EACX,CAAC;EACDC,OAAO,EAAE;IACPC,QAAQ,EAAE,IAAAC,SAAE,EAAC,EAAE,CAAC;IAChBC,WAAW,EAAE;EACf,CAAC;EACDC,IAAI,EAAE;IACJC,QAAQ,EAAE;EACZ,CAAC;EACDC,KAAK,EAAE;IACLD,QAAQ,EAAE,EAAE;IACZE,UAAU,EAAE;EACd;AACF,CAAC,CAAC;AAuBF,IAAMC,yBAAyB,GAAG,SAA5BA,yBAAyBA,CAG7BC,KAAyD,EACtD;EAAA,IAAAC,mBAAA;EACH,IACEC,wBAAwB,GAUtBF,KAAK,CAVPE,wBAAwB;IACxBC,UAAU,GASRH,KAAK,CATPG,UAAU;IACVC,cAAc,GAQZJ,KAAK,CARPI,cAAc;IACdC,iBAAiB,GAOfL,KAAK,CAPPK,iBAAiB;IACjBC,kBAAkB,GAMhBN,KAAK,CANPM,kBAAkB;IAClBC,YAAW,GAKTP,KAAK,CALPO,WAAW;IACXC,QAAO,GAILR,KAAK,CAJPQ,OAAO;IACPC,UAAS,GAGPT,KAAK,CAHPS,SAAS;IACTC,YAAY,GAEVV,KAAK,CAFPU,YAAY;IAAAC,aAAA,GAEVX,KAAK,CADPjB,MAAM;IAAE6B,UAAU,GAAAD,aAAA,cAAG,CAAC,CAAC,GAAAA,aAAA;EAGzB,IAAAE,SAAA,GAOI,IAAAC,sBAAQ,EAAC,CAAC;IAAAC,eAAA,GAAAF,SAAA,CANZG,KAAK;IAAAC,qBAAA,GAAAF,eAAA,CACHG,MAAM;IAAIC,KAAK,GAAAF,qBAAA,CAALE,KAAK;IAAEC,IAAI,GAAAH,qBAAA,CAAJG,IAAI;IAAEC,KAAK,GAAAJ,qBAAA,CAALI,KAAK;IAAAC,qBAAA,GAAAP,eAAA,CAC5BQ,aAAa,CACXC,IAAI;IAAItC,SAAS,GAAAoC,qBAAA,CAATpC,SAAS;IAAEK,OAAO,GAAA+B,qBAAA,CAAP/B,OAAO;IAAEkC,QAAQ,GAAAH,qBAAA,CAARG,QAAQ;IAAE5B,KAAK,GAAAyB,qBAAA,CAALzB,KAAK;EAKjD,IAAM6B,cAAc,GAAG,SAAjBA,cAAcA,CAAA;IAAA,OAAS,IAAAC,4BAAa,EAACxB,UAAU,CAACyB,SAAS,CAAC;EAAA;EAEhE,OACE1D,MAAA,YAAA2D,aAAA,CAACxD,YAAA,CAAAyD,gBAAgB,MAAAC,SAAA;IACfC,QAAQ,EAAEtB,YAAa;IACvBH,WAAW,EAAE,SAAAA,YAAC0B,KAAK,EAAK;MACtB,IAAI1B,YAAW,EAAE;QACfA,YAAW,CAAC;UACV2B,cAAc,EAAE;YAAE/B,UAAU,EAAVA;UAAW,CAAC;UAC9BgC,OAAO,EAAE,gBAAgB;UACzBF,KAAK,EAALA;QACF,CAAC,CAAC;MACJ;IACF,CAAE;IACFzB,OAAO,EAAE,SAAAA,QAACyB,KAAK,EAAK;MAClB,IAAIzB,QAAO,EAAE;QACXA,QAAO,CAAC;UACN0B,cAAc,EAAE;YAAE/B,UAAU,EAAVA;UAAW,CAAC;UAC9BiC,cAAc,EAAEV,cAAc;UAC9BS,OAAO,EAAE,gBAAgB;UACzBF,KAAK,EAALA;QACF,CAAC,CAAC;MACJ;IACF,CAAE;IACFxB,SAAS,EAAE,SAAAA,UAACwB,KAAK,EAAK;MACpB,IAAIxB,UAAS,EAAE;QACbA,UAAS,CAAC;UACRyB,cAAc,EAAE;YAAE/B,UAAU,EAAVA;UAAW,CAAC;UAC9BiC,cAAc,EAAEV,cAAc;UAC9BS,OAAO,EAAE,gBAAgB;UACzBF,KAAK,EAALA;QACF,CAAC,CAAC;MACJ;IACF,CAAE;IACFI,MAAM,EAAC;EAAiB,GACpBnC,wBAAwB;IAAAoC,MAAA,EAAAzD,KAAA;IAAA0D,QAAA;MAAAC,QAAA,EAAA1D,YAAA;MAAA2D,UAAA;MAAAC,YAAA;IAAA;EAAA,IAE5BxE,MAAA,YAAA2D,aAAA,CAACxD,YAAA,CAAAsE,IAAI;IAACC,KAAK,EAAE,CAAC7D,MAAM,CAACG,SAAS,EAAE;MAAE2D,eAAe,EAAExB;IAAM,CAAC,EAAEnC,SAAS,EAAE0B,UAAU,CAAC1B,SAAS,CAAE;IAAAoD,MAAA,EAAAzD,KAAA;IAAA0D,QAAA;MAAAC,QAAA,EAAA1D,YAAA;MAAA2D,UAAA;MAAAC,YAAA;IAAA;EAAA,GAC3FxE,MAAA,YAAA2D,aAAA,CAACvB,kBAAkB;IAACwC,QAAQ,EAAE3C,UAAU,CAAC4C,SAAU;IAACpD,IAAI,EAAES,cAAe;IAAAkC,MAAA,EAAAzD,KAAA;IAAA0D,QAAA;MAAAC,QAAA,EAAA1D,YAAA;MAAA2D,UAAA;MAAAC,YAAA;IAAA;EAAA,CAAE,CAAC,EAC5ExE,MAAA,YAAA2D,aAAA,CAACxD,YAAA,CAAAsE,IAAI;IAACC,KAAK,EAAE,CAAC7D,MAAM,CAACQ,OAAO,EAAEA,OAAO,EAAEqB,UAAU,CAACrB,OAAO,CAAE;IAAA+C,MAAA,EAAAzD,KAAA;IAAA0D,QAAA;MAAAC,QAAA,EAAA1D,YAAA;MAAA2D,UAAA;MAAAC,YAAA;IAAA;EAAA,GACzDxE,MAAA,YAAA2D,aAAA,CAACxD,YAAA,CAAA2E,IAAI;IAACC,aAAa,EAAE,CAAE;IAACL,KAAK,EAAE,CAAC7D,MAAM,CAACc,KAAK,EAAE;MAAEqD,KAAK,EAAE/B;IAAM,CAAC,EAAEtB,KAAK,EAAEe,UAAU,CAACf,KAAK,CAAE;IAAAyC,MAAA,EAAAzD,KAAA;IAAA0D,QAAA;MAAAC,QAAA,EAAA1D,YAAA;MAAA2D,UAAA;MAAAC,YAAA;IAAA;EAAA,GACtFvC,UAAU,CAACN,KACR,CAAC,EACP3B,MAAA,YAAA2D,aAAA,CAACxD,YAAA,CAAA2E,IAAI;IAACJ,KAAK,EAAE,CAAC7D,MAAM,CAACY,IAAI,EAAE;MAAEuD,KAAK,EAAE9B;IAAK,CAAC,EAAEK,QAAQ,EAAEb,UAAU,CAACjB,IAAI,CAAE;IAAA2C,MAAA,EAAAzD,KAAA;IAAA0D,QAAA;MAAAC,QAAA,EAAA1D,YAAA;MAAA2D,UAAA;MAAAC,YAAA;IAAA;EAAA,GACpES,sBAAsB,CAAChD,UAAU,CAACiD,SAAS,CACxC,CACF,CACF,CAAC,EACN,CAAAnD,mBAAA,GAAAE,UAAU,CAACkD,OAAO,aAAlBpD,mBAAA,CAAoBqD,MAAM,GAAGpF,MAAA,YAAA2D,aAAA,CAACxB,iBAAiB,MAAA0B,SAAA,iBAAK5B,UAAU;IAAAmC,MAAA,EAAAzD,KAAA;IAAA0D,QAAA;MAAAC,QAAA,EAAA1D,YAAA;MAAA2D,UAAA;MAAAC,YAAA;IAAA;EAAA,EAAG,CAAC,GAAG,IACtD,CAAC;AAEvB,CAAC;AAOM,IAAMa,cAAc,GAAG,SAAjBA,cAAcA,CAGzBvD,KAA8C,EAC3C;EACH,IAAAwD,kBAAA,GAA0D,IAAAC,iCAAiB,EAAqB,CAAC;IAAzFlD,WAAW,GAAAiD,kBAAA,CAAXjD,WAAW;IAAEC,OAAO,GAAAgD,kBAAA,CAAPhD,OAAO;IAAEC,SAAS,GAAA+C,kBAAA,CAAT/C,SAAS;IAAEC,YAAY,GAAA8C,kBAAA,CAAZ9C,YAAY;EACrD,IAAAgD,mBAAA,GAII,IAAAC,mCAAkB,EAAqB,CAAC;IAH1CzD,wBAAwB,GAAAwD,mBAAA,CAAxBxD,wBAAwB;IAAA0D,qBAAA,GAAAF,mBAAA,CACxBrD,iBAAiB;IAAjBA,iBAAiB,GAAAuD,qBAAA,cAAGC,oCAAwB,GAAAD,qBAAA;IAAAE,qBAAA,GAAAJ,mBAAA,CAC5CpD,kBAAkB;IAAlBA,kBAAkB,GAAAwD,qBAAA,cAAGC,kBAAe,GAAAD,qBAAA;EAGtC,OACE5F,MAAA,YAAA2D,aAAA,CAAC9B,yBAAyB,MAAAgC,SAAA;IAEtB7B,wBAAwB,EAAxBA,wBAAwB;IACxBG,iBAAiB,EAAjBA,iBAAiB;IACjBC,kBAAkB,EAAlBA,kBAAkB;IAClBC,WAAW,EAAXA,WAAW;IACXC,OAAO,EAAPA,OAAO;IACPC,SAAS,EAATA,SAAS;IACTC,YAAY,EAAZA;EAAY,GAEVV,KAAK;IAAAsC,MAAA,EAAAzD,KAAA;IAAA0D,QAAA;MAAAC,QAAA,EAAA1D,YAAA;MAAA2D,UAAA;MAAAC,YAAA;IAAA;EAAA,EACV,CAAC;AAEN,CAAC;AAACsB,OAAA,CAAAT,cAAA,GAAAA,cAAA;AAEK,IAAMJ,sBAAsB,GAAG,SAAzBA,sBAAsBA,CAAIxD,IAAsB,EAAK;EAChE,IAAI,CAACA,IAAI,EAAE;EACX,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;IAC5BA,IAAI,GAAGsE,UAAU,CAACtE,IAAI,CAAC;EACzB;EAEA,IAAIA,IAAI,GAAG,IAAI,GAAG,IAAI,EAAE;IACtB,OAAUuE,IAAI,CAACC,KAAK,CAACD,IAAI,CAACC,KAAK,CAACxE,IAAI,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;EACnD;EAEA,OAAUuE,IAAI,CAACC,KAAK,CAACD,IAAI,CAACC,KAAK,CAACxE,IAAI,GAAG,KAAK,CAAC,GAAG,GAAG,CAAC;AACtD,CAAC;AAACqE,OAAA,CAAAb,sBAAA,GAAAA,sBAAA;AAEFI,cAAc,CAACa,WAAW,GAAG,qCAAqC"}