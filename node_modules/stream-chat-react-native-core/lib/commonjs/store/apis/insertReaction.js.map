{"version":3,"names":["_mapReactionToStorable","require","_QuickSqliteClient","_createUpsertQuery","insertReaction","_ref","_ref$flush","flush","reaction","queries","push","createUpsertQuery","mapReactionToStorable","message_id","QuickSqliteClient","executeSqlBatch","exports"],"sources":["insertReaction.ts"],"sourcesContent":["import type { ReactionResponse } from 'stream-chat';\n\nimport { mapReactionToStorable } from '../mappers/mapReactionToStorable';\nimport { QuickSqliteClient } from '../QuickSqliteClient';\nimport { createUpsertQuery } from '../sqlite-utils/createUpsertQuery';\nimport type { PreparedQueries } from '../types';\n\nexport const insertReaction = ({\n  flush = true,\n  reaction,\n}: {\n  reaction: ReactionResponse;\n  flush?: boolean;\n}) => {\n  const queries: PreparedQueries[] = [];\n\n  queries.push(createUpsertQuery('reactions', mapReactionToStorable(reaction)));\n\n  queries.push([\n    'UPDATE messages SET reactionCounts = reactionCounts + 1 WHERE id = ?',\n    [reaction.message_id],\n  ]);\n\n  if (flush) {\n    QuickSqliteClient.executeSqlBatch(queries);\n  }\n\n  return queries;\n};\n"],"mappings":";;;;AAEA,IAAAA,sBAAA,GAAAC,OAAA;AACA,IAAAC,kBAAA,GAAAD,OAAA;AACA,IAAAE,kBAAA,GAAAF,OAAA;AAGO,IAAMG,cAAc,GAAG,SAAjBA,cAAcA,CAAAC,IAAA,EAMrB;EAAA,IAAAC,UAAA,GAAAD,IAAA,CALJE,KAAK;IAALA,KAAK,GAAAD,UAAA,cAAG,IAAI,GAAAA,UAAA;IACZE,QAAQ,GAAAH,IAAA,CAARG,QAAQ;EAKR,IAAMC,OAA0B,GAAG,EAAE;EAErCA,OAAO,CAACC,IAAI,CAAC,IAAAC,oCAAiB,EAAC,WAAW,EAAE,IAAAC,4CAAqB,EAACJ,QAAQ,CAAC,CAAC,CAAC;EAE7EC,OAAO,CAACC,IAAI,CAAC,CACX,sEAAsE,EACtE,CAACF,QAAQ,CAACK,UAAU,CAAC,CACtB,CAAC;EAEF,IAAIN,KAAK,EAAE;IACTO,oCAAiB,CAACC,eAAe,CAACN,OAAO,CAAC;EAC5C;EAEA,OAAOA,OAAO;AAChB,CAAC;AAACO,OAAA,CAAAZ,cAAA,GAAAA,cAAA"}