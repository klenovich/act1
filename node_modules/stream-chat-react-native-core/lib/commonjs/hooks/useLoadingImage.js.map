{"version":3,"names":["_react","require","_ChatContext","reducer","prevState","action","type","_extends2","isLoadingImage","isLoadingImageError","useLoadingImage","_useReducer","useReducer","_useReducer2","_slicedToArray2","imageState","dispatch","onReloadImageRef","useRef","setLoadingImageRef","setLoadingImageErrorRef","_useChatContext","useChatContext","isOnline","hasImageLoadedErroredRef","current","useEffect","onReloadImage","setLoadingImage","setLoadingImageError","exports"],"sources":["useLoadingImage.tsx"],"sourcesContent":["import { useEffect, useReducer, useRef } from 'react';\n\nimport { useChatContext } from '../contexts/chatContext/ChatContext';\n\ntype ImageState = {\n  isLoadingImage: boolean;\n  isLoadingImageError: boolean;\n};\n\ntype Action =\n  | { type: 'reloadImage' }\n  | { isLoadingImage: boolean; type: 'setLoadingImage' }\n  | { isLoadingImageError: boolean; type: 'setLoadingImageError' };\n\nfunction reducer(prevState: ImageState, action: Action) {\n  switch (action.type) {\n    case 'reloadImage':\n      return {\n        ...prevState,\n        isLoadingImage: true,\n        isLoadingImageError: false,\n      };\n    case 'setLoadingImage':\n      return { ...prevState, isLoadingImage: action.isLoadingImage };\n    case 'setLoadingImageError':\n      return { ...prevState, isLoadingImageError: action.isLoadingImageError };\n    default:\n      return prevState;\n  }\n}\nexport const useLoadingImage = () => {\n  const [imageState, dispatch] = useReducer(reducer, {\n    isLoadingImage: true,\n    isLoadingImageError: false,\n  });\n  const { isLoadingImage, isLoadingImageError } = imageState;\n  const onReloadImageRef = useRef(() => dispatch({ type: 'reloadImage' }));\n  const setLoadingImageRef = useRef((isLoadingImage: boolean) =>\n    dispatch({ isLoadingImage, type: 'setLoadingImage' }),\n  );\n  const setLoadingImageErrorRef = useRef((isLoadingImageError: boolean) =>\n    dispatch({ isLoadingImageError, type: 'setLoadingImageError' }),\n  );\n  const { isOnline } = useChatContext();\n\n  // storing the value of isLoadingImageError in a ref to avoid passing as a dep to useEffect\n  const hasImageLoadedErroredRef = useRef(isLoadingImageError);\n  hasImageLoadedErroredRef.current = isLoadingImageError;\n\n  useEffect(() => {\n    if (isOnline && hasImageLoadedErroredRef.current) {\n      // if there was an error previously, reload the image automatically when user comes back online\n      onReloadImageRef.current();\n    }\n  }, [isOnline]);\n\n  return {\n    isLoadingImage,\n    isLoadingImageError,\n    onReloadImage: onReloadImageRef.current,\n    setLoadingImage: setLoadingImageRef.current,\n    setLoadingImageError: setLoadingImageErrorRef.current,\n  };\n};\n"],"mappings":";;;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAEA,IAAAC,YAAA,GAAAD,OAAA;AAYA,SAASE,OAAOA,CAACC,SAAqB,EAAEC,MAAc,EAAE;EACtD,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAK,aAAa;MAChB,WAAAC,SAAA,iBACKH,SAAS;QACZI,cAAc,EAAE,IAAI;QACpBC,mBAAmB,EAAE;MAAK;IAE9B,KAAK,iBAAiB;MACpB,WAAAF,SAAA,iBAAYH,SAAS;QAAEI,cAAc,EAAEH,MAAM,CAACG;MAAc;IAC9D,KAAK,sBAAsB;MACzB,WAAAD,SAAA,iBAAYH,SAAS;QAAEK,mBAAmB,EAAEJ,MAAM,CAACI;MAAmB;IACxE;MACE,OAAOL,SAAS;EACpB;AACF;AACO,IAAMM,eAAe,GAAG,SAAlBA,eAAeA,CAAA,EAAS;EACnC,IAAAC,WAAA,GAA+B,IAAAC,iBAAU,EAACT,OAAO,EAAE;MACjDK,cAAc,EAAE,IAAI;MACpBC,mBAAmB,EAAE;IACvB,CAAC,CAAC;IAAAI,YAAA,OAAAC,eAAA,aAAAH,WAAA;IAHKI,UAAU,GAAAF,YAAA;IAAEG,QAAQ,GAAAH,YAAA;EAI3B,IAAQL,cAAc,GAA0BO,UAAU,CAAlDP,cAAc;IAAEC,mBAAmB,GAAKM,UAAU,CAAlCN,mBAAmB;EAC3C,IAAMQ,gBAAgB,GAAG,IAAAC,aAAM,EAAC;IAAA,OAAMF,QAAQ,CAAC;MAAEV,IAAI,EAAE;IAAc,CAAC,CAAC;EAAA,EAAC;EACxE,IAAMa,kBAAkB,GAAG,IAAAD,aAAM,EAAC,UAACV,cAAuB;IAAA,OACxDQ,QAAQ,CAAC;MAAER,cAAc,EAAdA,cAAc;MAAEF,IAAI,EAAE;IAAkB,CAAC,CAAC;EAAA,CACvD,CAAC;EACD,IAAMc,uBAAuB,GAAG,IAAAF,aAAM,EAAC,UAACT,mBAA4B;IAAA,OAClEO,QAAQ,CAAC;MAAEP,mBAAmB,EAAnBA,mBAAmB;MAAEH,IAAI,EAAE;IAAuB,CAAC,CAAC;EAAA,CACjE,CAAC;EACD,IAAAe,eAAA,GAAqB,IAAAC,2BAAc,EAAC,CAAC;IAA7BC,QAAQ,GAAAF,eAAA,CAARE,QAAQ;EAGhB,IAAMC,wBAAwB,GAAG,IAAAN,aAAM,EAACT,mBAAmB,CAAC;EAC5De,wBAAwB,CAACC,OAAO,GAAGhB,mBAAmB;EAEtD,IAAAiB,gBAAS,EAAC,YAAM;IACd,IAAIH,QAAQ,IAAIC,wBAAwB,CAACC,OAAO,EAAE;MAEhDR,gBAAgB,CAACQ,OAAO,CAAC,CAAC;IAC5B;EACF,CAAC,EAAE,CAACF,QAAQ,CAAC,CAAC;EAEd,OAAO;IACLf,cAAc,EAAdA,cAAc;IACdC,mBAAmB,EAAnBA,mBAAmB;IACnBkB,aAAa,EAAEV,gBAAgB,CAACQ,OAAO;IACvCG,eAAe,EAAET,kBAAkB,CAACM,OAAO;IAC3CI,oBAAoB,EAAET,uBAAuB,CAACK;EAChD,CAAC;AACH,CAAC;AAACK,OAAA,CAAApB,eAAA,GAAAA,eAAA"}