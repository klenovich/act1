{"version":3,"names":["_mapStorableToReaction","require","_mapStorableToUser","_excluded","mapStorableToMessage","_ref","currentUserId","messageRow","reactionRows","createdAt","deletedAt","extraData","reactionCounts","updatedAt","user","rest","_objectWithoutProperties2","latestReactions","map","reaction","mapStorableToReaction","ownReactions","filter","_reaction$user","id","_extends2","attachments","JSON","parse","created_at","deleted_at","latest_reactions","own_reactions","reaction_counts","updated_at","mapStorableToUser","exports"],"sources":["mapStorableToMessage.ts"],"sourcesContent":["import type { MessageResponse } from 'stream-chat';\n\nimport { mapStorableToReaction } from './mapStorableToReaction';\n\nimport { mapStorableToUser } from './mapStorableToUser';\n\nimport type { DefaultStreamChatGenerics } from '../../types/types';\n\nimport type { TableRowJoinedUser } from '../types';\n\nexport const mapStorableToMessage = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>({\n  currentUserId,\n  messageRow,\n  reactionRows,\n}: {\n  currentUserId: string;\n  messageRow: TableRowJoinedUser<'messages'>;\n  reactionRows: TableRowJoinedUser<'reactions'>[];\n}): MessageResponse<StreamChatGenerics> => {\n  const { createdAt, deletedAt, extraData, reactionCounts, updatedAt, user, ...rest } = messageRow;\n  const latestReactions =\n    reactionRows?.map((reaction) => mapStorableToReaction<StreamChatGenerics>(reaction)) || [];\n\n  const ownReactions = latestReactions.filter((reaction) => reaction.user?.id === currentUserId);\n\n  return {\n    ...rest,\n    attachments: messageRow.attachments ? JSON.parse(messageRow.attachments) : [],\n    created_at: createdAt,\n    deleted_at: deletedAt,\n    latest_reactions: latestReactions,\n    own_reactions: ownReactions,\n    reaction_counts: reactionCounts ? JSON.parse(reactionCounts) : {},\n    updated_at: updatedAt,\n    user: mapStorableToUser(user),\n    ...(extraData ? JSON.parse(extraData) : {}),\n  };\n};\n"],"mappings":";;;;;;;AAEA,IAAAA,sBAAA,GAAAC,OAAA;AAEA,IAAAC,kBAAA,GAAAD,OAAA;AAAwD,IAAAE,SAAA;AAMjD,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAoBA,CAAAC,IAAA,EAUU;EAAA,IAPzCC,aAAa,GAAAD,IAAA,CAAbC,aAAa;IACbC,UAAU,GAAAF,IAAA,CAAVE,UAAU;IACVC,YAAY,GAAAH,IAAA,CAAZG,YAAY;EAMZ,IAAQC,SAAS,GAAqEF,UAAU,CAAxFE,SAAS;IAAEC,SAAS,GAA0DH,UAAU,CAA7EG,SAAS;IAAEC,SAAS,GAA+CJ,UAAU,CAAlEI,SAAS;IAAEC,cAAc,GAA+BL,UAAU,CAAvDK,cAAc;IAAEC,SAAS,GAAoBN,UAAU,CAAvCM,SAAS;IAAEC,IAAI,GAAcP,UAAU,CAA5BO,IAAI;IAAKC,IAAI,OAAAC,yBAAA,aAAKT,UAAU,EAAAJ,SAAA;EAChG,IAAMc,eAAe,GACnB,CAAAT,YAAY,oBAAZA,YAAY,CAAEU,GAAG,CAAC,UAACC,QAAQ;IAAA,OAAK,IAAAC,4CAAqB,EAAqBD,QAAQ,CAAC;EAAA,EAAC,KAAI,EAAE;EAE5F,IAAME,YAAY,GAAGJ,eAAe,CAACK,MAAM,CAAC,UAACH,QAAQ;IAAA,IAAAI,cAAA;IAAA,OAAK,EAAAA,cAAA,GAAAJ,QAAQ,CAACL,IAAI,qBAAbS,cAAA,CAAeC,EAAE,MAAKlB,aAAa;EAAA,EAAC;EAE9F,WAAAmB,SAAA,iBACKV,IAAI;IACPW,WAAW,EAAEnB,UAAU,CAACmB,WAAW,GAAGC,IAAI,CAACC,KAAK,CAACrB,UAAU,CAACmB,WAAW,CAAC,GAAG,EAAE;IAC7EG,UAAU,EAAEpB,SAAS;IACrBqB,UAAU,EAAEpB,SAAS;IACrBqB,gBAAgB,EAAEd,eAAe;IACjCe,aAAa,EAAEX,YAAY;IAC3BY,eAAe,EAAErB,cAAc,GAAGe,IAAI,CAACC,KAAK,CAAChB,cAAc,CAAC,GAAG,CAAC,CAAC;IACjEsB,UAAU,EAAErB,SAAS;IACrBC,IAAI,EAAE,IAAAqB,oCAAiB,EAACrB,IAAI;EAAC,GACzBH,SAAS,GAAGgB,IAAI,CAACC,KAAK,CAACjB,SAAS,CAAC,GAAG,CAAC,CAAC;AAE9C,CAAC;AAACyB,OAAA,CAAAhC,oBAAA,GAAAA,oBAAA"}