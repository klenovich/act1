{"version":3,"names":["_react","require","_utils","_createForOfIteratorHelperLoose","o","allowArrayLike","it","Symbol","iterator","call","next","bind","Array","isArray","_unsupportedIterableToArray","length","i","done","value","TypeError","minLen","_arrayLikeToArray","n","Object","prototype","toString","slice","constructor","name","from","test","arr","len","arr2","isEditingBoolean","editing","exports","useMessageDetailsForState","message","initialValue","_useState","useState","_useState2","_slicedToArray2","fileUploads","setFileUploads","_useState3","_useState4","imageUploads","setImageUploads","_useState5","_useState6","mentionedUsers","setMentionedUsers","_useState7","_useState8","numberOfUploads","setNumberOfUploads","_useState9","_useState10","showMoreOptions","setShowMoreOptions","initialTextValue","_useState11","_useState12","text","setText","useEffect","messageValue","id","updated_at","mentioned_users","map","user","newFileUploads","newImageUploads","attachments","_iterator","_step","attachment","type","generateRandomId","push","file","mimeType","mime_type","title","size","file_size","state","url","asset_url","fallback","image_url","thumb_url"],"sources":["useMessageDetailsForState.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\n\nimport type { DefaultStreamChatGenerics } from '../../../types/types';\nimport { generateRandomId } from '../../../utils/utils';\n\nimport type { FileUpload, ImageUpload, MessageInputContextValue } from '../MessageInputContext';\n\nexport const isEditingBoolean = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  editing: MessageInputContextValue<StreamChatGenerics>['editing'],\n): editing is boolean => typeof editing === 'boolean';\n\nexport const useMessageDetailsForState = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  message: MessageInputContextValue<StreamChatGenerics>['editing'],\n  initialValue?: string,\n) => {\n  const [fileUploads, setFileUploads] = useState<FileUpload[]>([]);\n  const [imageUploads, setImageUploads] = useState<ImageUpload[]>([]);\n  const [mentionedUsers, setMentionedUsers] = useState<string[]>([]);\n  const [numberOfUploads, setNumberOfUploads] = useState(0);\n  const [showMoreOptions, setShowMoreOptions] = useState(true);\n  const initialTextValue = initialValue || '';\n  const [text, setText] = useState(initialTextValue);\n\n  useEffect(() => {\n    if (text !== initialTextValue) {\n      setShowMoreOptions(false);\n    }\n  }, [text]);\n\n  const messageValue =\n    typeof message === 'boolean' ? '' : `${message.id}${message.text}${message.updated_at}`;\n\n  useEffect(() => {\n    if (!isEditingBoolean<StreamChatGenerics>(message) && Array.isArray(message?.mentioned_users)) {\n      const mentionedUsers = message.mentioned_users.map((user) => user.id);\n      setMentionedUsers(mentionedUsers);\n    }\n  }, [messageValue]);\n\n  useEffect(() => {\n    if (message && !isEditingBoolean<StreamChatGenerics>(message)) {\n      setText(message?.text || '');\n      const newFileUploads: FileUpload[] = [];\n      const newImageUploads: ImageUpload[] = [];\n\n      const attachments = Array.isArray(message.attachments) ? message.attachments : [];\n\n      for (const attachment of attachments) {\n        if (attachment.type === 'file') {\n          const id = generateRandomId();\n          newFileUploads.push({\n            file: {\n              mimeType: attachment.mime_type,\n              name: attachment.title || '',\n              size: attachment.file_size,\n            },\n            id,\n            state: 'finished',\n            url: attachment.asset_url,\n          });\n        } else if (attachment.type === 'image') {\n          const id = generateRandomId();\n          newImageUploads.push({\n            file: {\n              name: attachment.fallback,\n              size: attachment.file_size,\n              type: attachment.type,\n            },\n            id,\n            state: 'finished',\n            url: attachment.image_url || attachment.asset_url || attachment.thumb_url,\n          });\n        } else if (attachment.type === 'video') {\n          const id = generateRandomId();\n          newFileUploads.push({\n            file: {\n              mimeType: attachment.mime_type,\n              name: attachment.title || '',\n              size: attachment.file_size,\n            },\n            id,\n            state: 'finished',\n            thumb_url: attachment.thumb_url,\n            url: attachment.asset_url,\n          });\n        }\n      }\n      if (newFileUploads.length) {\n        setFileUploads(newFileUploads);\n      }\n      if (newImageUploads.length) {\n        setImageUploads(newImageUploads);\n      }\n    }\n  }, [messageValue]);\n\n  return {\n    fileUploads,\n    imageUploads,\n    mentionedUsers,\n    numberOfUploads,\n    setFileUploads,\n    setImageUploads,\n    setMentionedUsers,\n    setNumberOfUploads,\n    setShowMoreOptions,\n    setText,\n    showMoreOptions,\n    text,\n  };\n};\n"],"mappings":"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"}