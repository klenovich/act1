{"version":3,"names":["_react","require","_ChatContext","getChannelPreviewDisplayAvatar","channel","client","_client$user","currentUserId","user","id","channelId","channelData","data","channelName","name","channelImage","image","_channel$state","members","Object","values","state","otherMembers","filter","member","_member$user","length","_otherMembers$0$user","_otherMembers$0$user2","_otherMembers$0$user3","ids","slice","map","_member$user2","images","_member$user3","names","_member$user4","exports","useChannelPreviewDisplayAvatar","_client$user2","_useChatContext","useChatContext","_useState","useState","_useState2","_slicedToArray2","displayAvatar","setDisplayAvatar","useEffect"],"sources":["useChannelPreviewDisplayAvatar.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\n\nimport type { Channel, StreamChat } from 'stream-chat';\n\nimport { useChatContext } from '../../../contexts/chatContext/ChatContext';\n\nimport type { DefaultStreamChatGenerics } from '../../../types/types';\n\nexport const getChannelPreviewDisplayAvatar = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  channel: Channel<StreamChatGenerics>,\n  client: StreamChat<StreamChatGenerics>,\n) => {\n  const currentUserId = client?.user?.id;\n  const channelId = channel?.id;\n  const channelData = channel?.data;\n  const channelName = channelData?.name;\n  const channelImage = channelData?.image;\n\n  if (channelImage) {\n    return {\n      id: channelId,\n      image: channelImage,\n      name: channelName,\n    };\n  } else if (currentUserId) {\n    const members = Object.values(channel.state?.members);\n    const otherMembers = members.filter((member) => member.user?.id !== currentUserId);\n\n    if (otherMembers.length === 1) {\n      return {\n        id: otherMembers[0].user?.id,\n        image: otherMembers[0].user?.image,\n        name: channelName || otherMembers[0].user?.name,\n      };\n    }\n\n    return {\n      ids: otherMembers.slice(0, 4).map((member) => member.user?.id || ''),\n      images: otherMembers.slice(0, 4).map((member) => member.user?.image || ''),\n      names: otherMembers.slice(0, 4).map((member) => member.user?.name || ''),\n    };\n  }\n  return {\n    id: channelId,\n    name: channelName,\n  };\n};\n\n/**\n * Hook to set the display avatar for channel preview\n * @param {*} channel\n *\n * @returns {object} e.g., { image: 'http://dummyurl.com/test.png', name: 'Uhtred Bebbanburg' }\n */\nexport const useChannelPreviewDisplayAvatar = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  channel: Channel<StreamChatGenerics>,\n) => {\n  const { client } = useChatContext<StreamChatGenerics>();\n\n  const channelData = channel?.data;\n  const image = channelData?.image;\n  const name = channelData?.name;\n  const id = client?.user?.id;\n\n  const [displayAvatar, setDisplayAvatar] = useState(\n    getChannelPreviewDisplayAvatar(channel, client),\n  );\n\n  useEffect(() => {\n    setDisplayAvatar(getChannelPreviewDisplayAvatar(channel, client));\n  }, [id, image, name]);\n\n  return displayAvatar;\n};\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAIA,IAAAC,YAAA,GAAAD,OAAA;AAIO,IAAME,8BAA8B,GAAG,SAAjCA,8BAA8BA,CAGzCC,OAAoC,EACpCC,MAAsC,EACnC;EAAA,IAAAC,YAAA;EACH,IAAMC,aAAa,GAAGF,MAAM,qBAAAC,YAAA,GAAND,MAAM,CAAEG,IAAI,qBAAZF,YAAA,CAAcG,EAAE;EACtC,IAAMC,SAAS,GAAGN,OAAO,oBAAPA,OAAO,CAAEK,EAAE;EAC7B,IAAME,WAAW,GAAGP,OAAO,oBAAPA,OAAO,CAAEQ,IAAI;EACjC,IAAMC,WAAW,GAAGF,WAAW,oBAAXA,WAAW,CAAEG,IAAI;EACrC,IAAMC,YAAY,GAAGJ,WAAW,oBAAXA,WAAW,CAAEK,KAAK;EAEvC,IAAID,YAAY,EAAE;IAChB,OAAO;MACLN,EAAE,EAAEC,SAAS;MACbM,KAAK,EAAED,YAAY;MACnBD,IAAI,EAAED;IACR,CAAC;EACH,CAAC,MAAM,IAAIN,aAAa,EAAE;IAAA,IAAAU,cAAA;IACxB,IAAMC,OAAO,GAAGC,MAAM,CAACC,MAAM,EAAAH,cAAA,GAACb,OAAO,CAACiB,KAAK,qBAAbJ,cAAA,CAAeC,OAAO,CAAC;IACrD,IAAMI,YAAY,GAAGJ,OAAO,CAACK,MAAM,CAAC,UAACC,MAAM;MAAA,IAAAC,YAAA;MAAA,OAAK,EAAAA,YAAA,GAAAD,MAAM,CAAChB,IAAI,qBAAXiB,YAAA,CAAahB,EAAE,MAAKF,aAAa;IAAA,EAAC;IAElF,IAAIe,YAAY,CAACI,MAAM,KAAK,CAAC,EAAE;MAAA,IAAAC,oBAAA,EAAAC,qBAAA,EAAAC,qBAAA;MAC7B,OAAO;QACLpB,EAAE,GAAAkB,oBAAA,GAAEL,YAAY,CAAC,CAAC,CAAC,CAACd,IAAI,qBAApBmB,oBAAA,CAAsBlB,EAAE;QAC5BO,KAAK,GAAAY,qBAAA,GAAEN,YAAY,CAAC,CAAC,CAAC,CAACd,IAAI,qBAApBoB,qBAAA,CAAsBZ,KAAK;QAClCF,IAAI,EAAED,WAAW,MAAAgB,qBAAA,GAAIP,YAAY,CAAC,CAAC,CAAC,CAACd,IAAI,qBAApBqB,qBAAA,CAAsBf,IAAI;MACjD,CAAC;IACH;IAEA,OAAO;MACLgB,GAAG,EAAER,YAAY,CAACS,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAACC,GAAG,CAAC,UAACR,MAAM;QAAA,IAAAS,aAAA;QAAA,OAAK,EAAAA,aAAA,GAAAT,MAAM,CAAChB,IAAI,qBAAXyB,aAAA,CAAaxB,EAAE,KAAI,EAAE;MAAA,EAAC;MACpEyB,MAAM,EAAEZ,YAAY,CAACS,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAACC,GAAG,CAAC,UAACR,MAAM;QAAA,IAAAW,aAAA;QAAA,OAAK,EAAAA,aAAA,GAAAX,MAAM,CAAChB,IAAI,qBAAX2B,aAAA,CAAanB,KAAK,KAAI,EAAE;MAAA,EAAC;MAC1EoB,KAAK,EAAEd,YAAY,CAACS,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAACC,GAAG,CAAC,UAACR,MAAM;QAAA,IAAAa,aAAA;QAAA,OAAK,EAAAA,aAAA,GAAAb,MAAM,CAAChB,IAAI,qBAAX6B,aAAA,CAAavB,IAAI,KAAI,EAAE;MAAA;IACzE,CAAC;EACH;EACA,OAAO;IACLL,EAAE,EAAEC,SAAS;IACbI,IAAI,EAAED;EACR,CAAC;AACH,CAAC;AAACyB,OAAA,CAAAnC,8BAAA,GAAAA,8BAAA;AAQK,IAAMoC,8BAA8B,GAAG,SAAjCA,8BAA8BA,CAGzCnC,OAAoC,EACjC;EAAA,IAAAoC,aAAA;EACH,IAAAC,eAAA,GAAmB,IAAAC,2BAAc,EAAqB,CAAC;IAA/CrC,MAAM,GAAAoC,eAAA,CAANpC,MAAM;EAEd,IAAMM,WAAW,GAAGP,OAAO,oBAAPA,OAAO,CAAEQ,IAAI;EACjC,IAAMI,KAAK,GAAGL,WAAW,oBAAXA,WAAW,CAAEK,KAAK;EAChC,IAAMF,IAAI,GAAGH,WAAW,oBAAXA,WAAW,CAAEG,IAAI;EAC9B,IAAML,EAAE,GAAGJ,MAAM,qBAAAmC,aAAA,GAANnC,MAAM,CAAEG,IAAI,qBAAZgC,aAAA,CAAc/B,EAAE;EAE3B,IAAAkC,SAAA,GAA0C,IAAAC,eAAQ,EAChDzC,8BAA8B,CAACC,OAAO,EAAEC,MAAM,CAChD,CAAC;IAAAwC,UAAA,OAAAC,eAAA,aAAAH,SAAA;IAFMI,aAAa,GAAAF,UAAA;IAAEG,gBAAgB,GAAAH,UAAA;EAItC,IAAAI,gBAAS,EAAC,YAAM;IACdD,gBAAgB,CAAC7C,8BAA8B,CAACC,OAAO,EAAEC,MAAM,CAAC,CAAC;EACnE,CAAC,EAAE,CAACI,EAAE,EAAEO,KAAK,EAAEF,IAAI,CAAC,CAAC;EAErB,OAAOiC,aAAa;AACtB,CAAC;AAACT,OAAA,CAAAC,8BAAA,GAAAA,8BAAA"}