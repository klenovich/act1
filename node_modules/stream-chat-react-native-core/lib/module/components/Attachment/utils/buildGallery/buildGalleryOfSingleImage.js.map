{"version":3,"names":["_buildThumbnail","require","_getAspectRatio","clamp","number","min","max","Math","getContainerSize","_ref","image","sizeConfig","height","original_height","width","original_width","gridHeight","gridWidth","maxHeight","maxWidth","minHeight","minWidth","aspectRatio","getAspectRatio","containerHeight","containerWidth","buildGalleryOfSingleImage","_ref2","container","thumbnail","buildThumbnail","_extends2","column","thumbnailGrid"],"sources":["buildGalleryOfSingleImage.ts"],"sourcesContent":["import type { Attachment } from 'stream-chat';\n\nimport { buildThumbnail } from './buildThumbnail';\n\nimport type { GallerySizeAndThumbnailGrid, GallerySizeConfig } from './types';\n\nimport type { DefaultStreamChatGenerics } from '../../../../types/types';\nimport { getAspectRatio } from '../getAspectRatio';\n\n/**\n * Bound a number to a range.\n * @param number The number to bound.\n * @param min The minimum value.\n * @param max The maximum value.\n *\n * @returns The bounded number.\n */\nfunction clamp(number: number, min: number, max: number) {\n  return Math.min(Math.max(number, min), max);\n}\n\nfunction getContainerSize<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>({ image, sizeConfig }: { image: Attachment<StreamChatGenerics>; sizeConfig: GallerySizeConfig }) {\n  const { original_height: height, original_width: width } = image;\n  const { gridHeight, gridWidth, maxHeight, maxWidth, minHeight, minWidth } = sizeConfig;\n\n  if (!height || !width) {\n    return { height: gridHeight, width: gridWidth };\n  }\n\n  const aspectRatio = getAspectRatio(image);\n\n  if (aspectRatio <= 1) {\n    const containerHeight = clamp(height, minHeight, maxHeight);\n    const containerWidth = clamp(containerHeight * aspectRatio, minWidth, maxWidth);\n\n    if (containerWidth === maxWidth) {\n      return {\n        height: clamp(containerWidth / aspectRatio, minHeight, maxHeight),\n        width: containerWidth,\n      };\n    }\n    return {\n      height: containerHeight,\n      width: containerWidth,\n    };\n  }\n\n  const containerWidth = clamp(width, minWidth, maxWidth);\n  const containerHeight = clamp(containerWidth / aspectRatio, minHeight, maxHeight);\n\n  if (containerHeight === maxHeight) {\n    return {\n      height: containerHeight,\n      width: clamp(containerHeight * aspectRatio, minHeight, maxHeight),\n    };\n  }\n\n  return {\n    height: containerHeight,\n    width: containerWidth,\n  };\n}\n\nexport function buildGalleryOfSingleImage<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>({\n  image,\n  sizeConfig,\n}: {\n  image: Attachment<StreamChatGenerics>;\n  sizeConfig: GallerySizeConfig;\n}): GallerySizeAndThumbnailGrid {\n  const container = getContainerSize({\n    image,\n    sizeConfig,\n  });\n\n  const thumbnail = buildThumbnail({\n    image,\n    ...container,\n  });\n\n  const column = [thumbnail];\n\n  return {\n    ...container,\n    thumbnailGrid: [column],\n  };\n}\n"],"mappings":";;;;;;AAEA,IAAAA,eAAA,GAAAC,OAAA;AAKA,IAAAC,eAAA,GAAAD,OAAA;AAUA,SAASE,KAAKA,CAACC,MAAc,EAAEC,GAAW,EAAEC,GAAW,EAAE;EACvD,OAAOC,IAAI,CAACF,GAAG,CAACE,IAAI,CAACD,GAAG,CAACF,MAAM,EAAEC,GAAG,CAAC,EAAEC,GAAG,CAAC;AAC7C;AAEA,SAASE,gBAAgBA,CAAAC,IAAA,EAE0E;EAAA,IAA/FC,KAAK,GAAAD,IAAA,CAALC,KAAK;IAAEC,UAAU,GAAAF,IAAA,CAAVE,UAAU;EACnB,IAAyBC,MAAM,GAA4BF,KAAK,CAAxDG,eAAe;IAA0BC,KAAK,GAAKJ,KAAK,CAA/BK,cAAc;EAC/C,IAAQC,UAAU,GAA0DL,UAAU,CAA9EK,UAAU;IAAEC,SAAS,GAA+CN,UAAU,CAAlEM,SAAS;IAAEC,SAAS,GAAoCP,UAAU,CAAvDO,SAAS;IAAEC,QAAQ,GAA0BR,UAAU,CAA5CQ,QAAQ;IAAEC,SAAS,GAAeT,UAAU,CAAlCS,SAAS;IAAEC,QAAQ,GAAKV,UAAU,CAAvBU,QAAQ;EAEvE,IAAI,CAACT,MAAM,IAAI,CAACE,KAAK,EAAE;IACrB,OAAO;MAAEF,MAAM,EAAEI,UAAU;MAAEF,KAAK,EAAEG;IAAU,CAAC;EACjD;EAEA,IAAMK,WAAW,GAAG,IAAAC,8BAAc,EAACb,KAAK,CAAC;EAEzC,IAAIY,WAAW,IAAI,CAAC,EAAE;IACpB,IAAME,gBAAe,GAAGrB,KAAK,CAACS,MAAM,EAAEQ,SAAS,EAAEF,SAAS,CAAC;IAC3D,IAAMO,eAAc,GAAGtB,KAAK,CAACqB,gBAAe,GAAGF,WAAW,EAAED,QAAQ,EAAEF,QAAQ,CAAC;IAE/E,IAAIM,eAAc,KAAKN,QAAQ,EAAE;MAC/B,OAAO;QACLP,MAAM,EAAET,KAAK,CAACsB,eAAc,GAAGH,WAAW,EAAEF,SAAS,EAAEF,SAAS,CAAC;QACjEJ,KAAK,EAAEW;MACT,CAAC;IACH;IACA,OAAO;MACLb,MAAM,EAAEY,gBAAe;MACvBV,KAAK,EAAEW;IACT,CAAC;EACH;EAEA,IAAMA,cAAc,GAAGtB,KAAK,CAACW,KAAK,EAAEO,QAAQ,EAAEF,QAAQ,CAAC;EACvD,IAAMK,eAAe,GAAGrB,KAAK,CAACsB,cAAc,GAAGH,WAAW,EAAEF,SAAS,EAAEF,SAAS,CAAC;EAEjF,IAAIM,eAAe,KAAKN,SAAS,EAAE;IACjC,OAAO;MACLN,MAAM,EAAEY,eAAe;MACvBV,KAAK,EAAEX,KAAK,CAACqB,eAAe,GAAGF,WAAW,EAAEF,SAAS,EAAEF,SAAS;IAClE,CAAC;EACH;EAEA,OAAO;IACLN,MAAM,EAAEY,eAAe;IACvBV,KAAK,EAAEW;EACT,CAAC;AACH;AAEO,SAASC,yBAAyBA,CAAAC,KAAA,EAQT;EAAA,IAL9BjB,KAAK,GAAAiB,KAAA,CAALjB,KAAK;IACLC,UAAU,GAAAgB,KAAA,CAAVhB,UAAU;EAKV,IAAMiB,SAAS,GAAGpB,gBAAgB,CAAC;IACjCE,KAAK,EAALA,KAAK;IACLC,UAAU,EAAVA;EACF,CAAC,CAAC;EAEF,IAAMkB,SAAS,GAAG,IAAAC,8BAAc,MAAAC,SAAA;IAC9BrB,KAAK,EAALA;EAAK,GACFkB,SAAS,CACb,CAAC;EAEF,IAAMI,MAAM,GAAG,CAACH,SAAS,CAAC;EAE1B,WAAAE,SAAA,iBACKH,SAAS;IACZK,aAAa,EAAE,CAACD,MAAM;EAAC;AAE3B"}