{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_dayjs","_interopRequireDefault","_duration","_contexts","_icons","_native","_ProgressControl","_this","_jsxFileName","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","_typeof","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","dayjs","extend","duration","FILE_PREVIEW_HEIGHT","styles","StyleSheet","create","fileContainer","borderRadius","borderWidth","flexDirection","height","paddingLeft","paddingRight","fileContentContainer","filenameText","fontSize","fontWeight","fileTextContainer","justifyContent","flatList","marginBottom","maxHeight","overlay","marginLeft","marginRight","progressControlView","flex","progressDurationText","roundedView","alignItems","alignSelf","display","elevation","shadowOffset","width","shadowOpacity","shadowRadius","AudioAttachmentWithContext","props","soundRef","React","useRef","item","onLoad","onPlayPause","onProgress","handleLoad","payload","id","handleProgress","data","currentTime","seekableDuration","handlePlayPause","_ref","_asyncToGenerator2","_regenerator","mark","_callee","isPausedStatusAvailable","wrap","_callee$","_context","prev","next","current","undefined","progress","seek","setPositionAsync","paused","playAsync","pauseAsync","stop","_x","apply","arguments","handleProgressDrag","_ref2","_callee2","position","_soundRef$current","_soundRef$current2","_callee2$","_context2","_x2","handleEnd","onPlaybackStatusUpdate","playbackStatus","isLoaded","error","console","log","durationMillis","positionMillis","isPlaying","isBuffering","didJustFinish","isLooping","useEffect","Sound","Player","initiateSound","_ref3","_callee3","_callee3$","_context3","file","uri","initializeSound","sent","_soundRef$current3","stopAsync","unloadAsync","initalPlayPause","_ref4","_callee4","_callee4$","_context4","_useTheme","useTheme","_useTheme$theme","theme","_useTheme$theme$color","colors","accent_blue","black","grey_dark","static_black","static_white","_useTheme$theme$messa","messageInput","fileUploadPreview","_useTheme$theme$messa2","audioAttachment","progressValueInSeconds","progressDuration","format","lastIndexOfDot","name","lastIndexOf","createElement","View","style","__self","__source","fileName","lineNumber","columnNumber","TouchableOpacity","accessibilityLabel","onPress","backgroundColor","shadowColor","Play","pathFill","Pause","Text","numberOfLines","color","I18nManager","isRTL","writingDirection","slice","onEnd","testID","ProgressControl","filledColor","onProgressDrag","AudioAttachment","_extends2","exports","displayName"],"sources":["AudioAttachment.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { I18nManager, StyleSheet, Text, TouchableOpacity, View } from 'react-native';\n\nimport dayjs from 'dayjs';\nimport duration from 'dayjs/plugin/duration';\n\nimport { FileUpload, useTheme } from '../../contexts';\nimport { Pause, Play } from '../../icons';\nimport {\n  PlaybackStatus,\n  Sound,\n  SoundReturnType,\n  VideoPayloadData,\n  VideoProgressData,\n} from '../../native';\nimport { ProgressControl } from '../ProgressControl/ProgressControl';\n\ndayjs.extend(duration);\n\nconst FILE_PREVIEW_HEIGHT = 70;\n\nconst styles = StyleSheet.create({\n  fileContainer: {\n    borderRadius: 12,\n    borderWidth: 1,\n    flexDirection: 'row',\n    height: FILE_PREVIEW_HEIGHT,\n    paddingLeft: 8,\n    paddingRight: 8,\n  },\n  fileContentContainer: { flexDirection: 'row', paddingRight: 40 },\n  filenameText: {\n    fontSize: 14,\n    fontWeight: 'bold',\n    paddingLeft: 10,\n  },\n  fileTextContainer: {\n    justifyContent: 'space-around',\n  },\n  flatList: { marginBottom: 12, maxHeight: FILE_PREVIEW_HEIGHT * 2.5 + 16 },\n  overlay: {\n    borderRadius: 12,\n    marginLeft: 8,\n    marginRight: 8,\n  },\n  progressControlView: {\n    flex: 8,\n  },\n  progressDurationText: {\n    flex: 4,\n    fontSize: 12,\n    paddingLeft: 10,\n    paddingRight: 8,\n  },\n  roundedView: {\n    alignItems: 'center',\n    alignSelf: 'center',\n    borderRadius: 50,\n    display: 'flex',\n    elevation: 4,\n    height: 36,\n    justifyContent: 'center',\n    shadowOffset: {\n      height: 2,\n      width: 0,\n    },\n    shadowOpacity: 0.23,\n    shadowRadius: 2.62,\n    width: 36,\n  },\n});\n\nexport type AudioAttachmentPropsWithContext = {\n  item: Omit<FileUpload, 'state'>;\n  onLoad: (index: string, duration: number) => void;\n  onPlayPause: (index: string, pausedStatus?: boolean) => void;\n  onProgress: (index: string, currentTime?: number, hasEnd?: boolean) => void;\n  testID?: string;\n};\n\nconst AudioAttachmentWithContext = (props: AudioAttachmentPropsWithContext) => {\n  const soundRef = React.useRef<SoundReturnType | null>(null);\n  const { item, onLoad, onPlayPause, onProgress } = props;\n\n  const handleLoad = (payload: VideoPayloadData) => {\n    onLoad(item.id, payload.duration);\n  };\n\n  const handleProgress = (data: VideoProgressData) => {\n    if (data.currentTime && data.seekableDuration) {\n      onProgress(item.id, data.currentTime);\n    }\n  };\n\n  const handlePlayPause = async (isPausedStatusAvailable?: boolean) => {\n    if (soundRef.current) {\n      if (isPausedStatusAvailable === undefined) {\n        if (item.progress === 1) {\n          // For native CLI\n          if (soundRef.current.seek) soundRef.current.seek(0);\n          // For expo CLI\n          if (soundRef.current.setPositionAsync) soundRef.current.setPositionAsync(0);\n        }\n        if (item.paused) {\n          if (soundRef.current.playAsync) await soundRef.current.playAsync();\n          onPlayPause(item.id, false);\n        } else {\n          if (soundRef.current.pauseAsync) await soundRef.current.pauseAsync();\n          onPlayPause(item.id, true);\n        }\n      } else {\n        onPlayPause(item.id, isPausedStatusAvailable);\n      }\n    }\n  };\n\n  const handleProgressDrag = async (position: number) => {\n    onProgress(item.id, position);\n    if (soundRef.current?.seek) soundRef.current.seek(position);\n    if (soundRef.current?.setPositionAsync) {\n      await soundRef.current.setPositionAsync(position * 1000);\n    }\n  };\n\n  const handleEnd = () => {\n    onPlayPause(item.id, true);\n    onProgress(item.id, item.duration, true);\n  };\n\n  const onPlaybackStatusUpdate = (playbackStatus: PlaybackStatus) => {\n    if (!playbackStatus.isLoaded) {\n      // Update your UI for the unloaded state\n      if (playbackStatus.error) {\n        console.log(`Encountered a fatal error during playback: ${playbackStatus.error}`);\n      }\n    } else {\n      const { durationMillis, positionMillis } = playbackStatus;\n      onLoad(item.id, durationMillis / 1000);\n      // Update your UI for the loaded state\n      if (playbackStatus.isPlaying) {\n        // Update your UI for the playing state\n        onProgress(item.id, positionMillis / 1000);\n      } else {\n        // Update your UI for the paused state\n      }\n\n      if (playbackStatus.isBuffering) {\n        // Update your UI for the buffering state\n      }\n\n      if (playbackStatus.didJustFinish && !playbackStatus.isLooping) {\n        // The player has just finished playing and will stop. Maybe you want to play something else?\n        // status: opposite of pause,says i am playing\n        handleEnd();\n      }\n    }\n  };\n\n  useEffect(() => {\n    if (Sound.Player === null) {\n      const initiateSound = async () => {\n        if (item && item.file && item.file.uri) {\n          soundRef.current = await Sound.initializeSound(\n            { uri: item.file.uri },\n            {},\n            onPlaybackStatusUpdate,\n          );\n        }\n      };\n      initiateSound();\n    }\n\n    return () => {\n      if (soundRef.current?.stopAsync && soundRef.current.unloadAsync) {\n        soundRef.current.stopAsync();\n        soundRef.current.unloadAsync();\n      }\n    };\n  }, []);\n\n  // This is needed for expo applications where the rerender doesn't occur on time thefore you need to update the state of the sound.\n  useEffect(() => {\n    const initalPlayPause = async () => {\n      if (soundRef.current) {\n        if (item.paused) {\n          if (soundRef.current.pauseAsync) await soundRef.current.pauseAsync();\n        } else {\n          if (soundRef.current.playAsync) await soundRef.current.playAsync();\n        }\n      }\n    };\n    if (!Sound.Player) {\n      initalPlayPause();\n    }\n  }, [item.paused]);\n\n  const {\n    theme: {\n      colors: { accent_blue, black, grey_dark, static_black, static_white },\n      messageInput: {\n        fileUploadPreview: {\n          audioAttachment: { progressControlView, progressDurationText, roundedView },\n          fileContentContainer,\n          filenameText,\n          fileTextContainer,\n        },\n      },\n    },\n  } = useTheme();\n\n  const progressValueInSeconds = (item.duration as number) * (item.progress as number);\n\n  const progressDuration = progressValueInSeconds\n    ? progressValueInSeconds / 3600 >= 1\n      ? dayjs.duration(progressValueInSeconds, 'second').format('HH:mm:ss')\n      : dayjs.duration(progressValueInSeconds, 'second').format('mm:ss')\n    : '00:00';\n\n  const lastIndexOfDot = item.file.name.lastIndexOf('.');\n\n  return (\n    <View style={[styles.fileContentContainer, fileContentContainer]}>\n      <TouchableOpacity\n        accessibilityLabel='Play Pause Button'\n        onPress={() => handlePlayPause()}\n        style={[\n          styles.roundedView,\n          roundedView,\n          { backgroundColor: static_white, shadowColor: black },\n        ]}\n      >\n        {item.paused ? (\n          <Play height={24} pathFill={static_black} width={24} />\n        ) : (\n          <Pause height={24} pathFill={static_black} width={24} />\n        )}\n      </TouchableOpacity>\n      <View style={[styles.fileTextContainer, fileTextContainer]}>\n        <Text\n          accessibilityLabel='File Name'\n          numberOfLines={1}\n          style={[\n            styles.filenameText,\n            {\n              color: black,\n              width:\n                16 - // 16 = horizontal padding\n                40 - // 40 = file icon size\n                24 - // 24 = close icon size\n                24, // 24 = internal padding\n            },\n            I18nManager.isRTL ? { writingDirection: 'rtl' } : { writingDirection: 'ltr' },\n            filenameText,\n          ]}\n        >\n          {item.file.name.slice(0, 12) + '...' + item.file.name.slice(lastIndexOfDot)}\n        </Text>\n        <View\n          style={{\n            alignItems: 'center',\n            display: 'flex',\n            flexDirection: 'row',\n          }}\n        >\n          {/* <ExpoSoundPlayer filePaused={!!item.paused} soundRef={soundRef} /> */}\n          {Sound.Player && (\n            <Sound.Player\n              onEnd={handleEnd}\n              onLoad={handleLoad}\n              onProgress={handleProgress}\n              paused={item.paused as boolean}\n              soundRef={soundRef}\n              testID='sound-player'\n              uri={item.file.uri}\n            />\n          )}\n          <Text style={[styles.progressDurationText, { color: grey_dark }, progressDurationText]}>\n            {progressDuration}\n          </Text>\n          <View style={[styles.progressControlView, progressControlView]}>\n            <ProgressControl\n              duration={item.duration as number}\n              filledColor={accent_blue}\n              onPlayPause={handlePlayPause}\n              onProgressDrag={handleProgressDrag}\n              progress={item.progress as number}\n              testID='progress-control'\n              width={120}\n            />\n          </View>\n        </View>\n      </View>\n    </View>\n  );\n};\n\nexport type AudioAttachmentProps = Partial<AudioAttachmentPropsWithContext> & {\n  item: Omit<FileUpload, 'state'>;\n  onLoad: (index: string, duration: number) => void;\n  onPlayPause: (index: string, pausedStatus?: boolean) => void;\n  onProgress: (index: string, currentTime?: number, hasEnd?: boolean) => void;\n  testID: string;\n};\n\n/**\n * AudioAttachment\n * UI Component to preview the audio files\n */\nexport const AudioAttachment = (props: AudioAttachmentProps) => (\n  <AudioAttachmentWithContext {...props} />\n);\n\nAudioAttachment.displayName = 'AudioAttachment{messageInput{autoAttachment}}';\n"],"mappings":"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"}