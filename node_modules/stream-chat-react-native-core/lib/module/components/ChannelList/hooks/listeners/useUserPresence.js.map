{"version":3,"names":["_react","require","_ChatContext","useUserPresence","_ref","setChannels","_useChatContext","useChatContext","client","useEffect","handleEvent","event","channels","newChannels","map","channel","_event$user","user","id","state","members","_toConsumableArray2","listeners","on","forEach","l","unsubscribe","exports"],"sources":["useUserPresence.ts"],"sourcesContent":["import { useEffect } from 'react';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport { useChatContext } from '../../../../contexts/chatContext/ChatContext';\n\nimport type { DefaultStreamChatGenerics } from '../../../../types/types';\n\ntype Parameters<StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics> =\n  {\n    setChannels: React.Dispatch<React.SetStateAction<Channel<StreamChatGenerics>[] | null>>;\n  };\n\nexport const useUserPresence = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>({\n  setChannels,\n}: Parameters<StreamChatGenerics>) => {\n  const { client } = useChatContext<StreamChatGenerics>();\n\n  useEffect(() => {\n    const handleEvent = (event: Event<StreamChatGenerics>) => {\n      setChannels((channels) => {\n        if (!channels) return channels;\n\n        const newChannels = channels.map((channel) => {\n          if (!event.user?.id || !channel.state.members[event.user.id]) {\n            return channel;\n          }\n          channel.state.members[event.user.id].user = event.user;\n          return channel;\n        });\n\n        return [...newChannels];\n      });\n    };\n\n    const listeners = [\n      client?.on('user.presence.changed', handleEvent),\n      client?.on('user.updated', handleEvent),\n    ];\n\n    return () => {\n      listeners?.forEach((l) => l?.unsubscribe());\n    };\n  }, []);\n};\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAIA,IAAAC,YAAA,GAAAD,OAAA;AASO,IAAME,eAAe,GAAG,SAAlBA,eAAeA,CAAAC,IAAA,EAIU;EAAA,IADpCC,WAAW,GAAAD,IAAA,CAAXC,WAAW;EAEX,IAAAC,eAAA,GAAmB,IAAAC,2BAAc,EAAqB,CAAC;IAA/CC,MAAM,GAAAF,eAAA,CAANE,MAAM;EAEd,IAAAC,gBAAS,EAAC,YAAM;IACd,IAAMC,WAAW,GAAG,SAAdA,WAAWA,CAAIC,KAAgC,EAAK;MACxDN,WAAW,CAAC,UAACO,QAAQ,EAAK;QACxB,IAAI,CAACA,QAAQ,EAAE,OAAOA,QAAQ;QAE9B,IAAMC,WAAW,GAAGD,QAAQ,CAACE,GAAG,CAAC,UAACC,OAAO,EAAK;UAAA,IAAAC,WAAA;UAC5C,IAAI,GAAAA,WAAA,GAACL,KAAK,CAACM,IAAI,aAAVD,WAAA,CAAYE,EAAE,KAAI,CAACH,OAAO,CAACI,KAAK,CAACC,OAAO,CAACT,KAAK,CAACM,IAAI,CAACC,EAAE,CAAC,EAAE;YAC5D,OAAOH,OAAO;UAChB;UACAA,OAAO,CAACI,KAAK,CAACC,OAAO,CAACT,KAAK,CAACM,IAAI,CAACC,EAAE,CAAC,CAACD,IAAI,GAAGN,KAAK,CAACM,IAAI;UACtD,OAAOF,OAAO;QAChB,CAAC,CAAC;QAEF,WAAAM,mBAAA,aAAWR,WAAW;MACxB,CAAC,CAAC;IACJ,CAAC;IAED,IAAMS,SAAS,GAAG,CAChBd,MAAM,oBAANA,MAAM,CAAEe,EAAE,CAAC,uBAAuB,EAAEb,WAAW,CAAC,EAChDF,MAAM,oBAANA,MAAM,CAAEe,EAAE,CAAC,cAAc,EAAEb,WAAW,CAAC,CACxC;IAED,OAAO,YAAM;MACXY,SAAS,oBAATA,SAAS,CAAEE,OAAO,CAAC,UAACC,CAAC;QAAA,OAAKA,CAAC,oBAADA,CAAC,CAAEC,WAAW,CAAC,CAAC;MAAA,EAAC;IAC7C,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;AACR,CAAC;AAACC,OAAA,CAAAxB,eAAA,GAAAA,eAAA"}